<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React è¿›é˜¶æ¦‚å¿µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../../global.css"> <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        /* Minimal inline styles - Primarily rely on global.css and Tailwind */

        /* --- Base & Layout Adjustments --- */
        html {
            scroll-padding-top: 6rem; /* Adjust based on potential sticky header */
        }

        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
            background-color: var(--bg-color-lighter, #f3f4f6);
            color: var(--text-color-default, #374151); /* Ensure default text color */
        }

        /* --- Typography & Content Adjustments --- */
        h1, h2, h3, h4, h5, h6 {
            scroll-margin-top: 6rem;
        }

        h2 { /* Add bottom border and adjust margin */
            border-bottom: 1px solid var(--border-color-light, #e5e7eb);
            padding-bottom: 0.5rem; /* pb-2 */
            margin-bottom: 2rem; /* Increased margin mb-8 */
        }
        h3.head3 { /* Ensure consistent margin below H3 in cards */
             margin-bottom: 1rem; /* mb-4 */
        }

        /* Improve paragraph spacing */
        p {
            margin-bottom: 1rem; /* mb-4 */
            line-height: var(--base-line-height, 1.65); /* Ensure consistent line height */
        }
        p:last-child {
            margin-bottom: 0; /* Remove margin from last paragraph in a block */
        }
        ul, ol { /* Add margin below lists */
            margin-bottom: 1rem; /* mb-4 */
        }
        ul:last-child, ol:last-child {
             margin-bottom: 0;
        }
        /* Adjust list item spacing */
        li {
            margin-bottom: 0.5rem; /* mb-2 */
        }


        /* Style for frequency/level tags */
        .level-tag {
            display: inline-block;
            margin-left: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.1rem 0.5rem;
            border-radius: 0.25rem;
            vertical-align: middle;
            border: 1px solid transparent;
        }
        .level-tag-low {
            background-color: var(--secondary-color-light, #ecfdf5);
            color: var(--secondary-color, #10b981);
            border-color: var(--secondary-color, #10b981);
        }
        .level-tag-base {
            background-color: var(--bg-color-lighter, #f3f4f6);
            color: var(--text-color-light, #6b7280);
            border-color: var(--border-color-default, #d1d5db);
        }

        /* --- Code Block Styling --- */
        pre[class*="language-"] {
             margin-top: 1rem;
             margin-bottom: 1.5rem; /* Increased margin mb-6 */
             max-height: 400px;
             overflow: auto;
             border-radius: var(--card-border-radius, 0.5rem); /* Use card radius */
             border: 1px solid var(--border-color-light, #e5e7eb); /* Add subtle border */
        }

        /* --- Card Styling Refinements --- */
        .content-card {
            background-color: var(--bg-color-white, white);
            border-radius: var(--card-border-radius, 0.75rem); /* Softer radius (rounded-xl) */
            box-shadow: var(--card-shadow-default, 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)); /* Tailwind shadow-md */
            padding: var(--card-padding, 1.5rem); /* p-6 */
            margin-bottom: 2rem; /* Increased spacing mb-8 */
            border: 1px solid var(--border-color-light, #e5e7eb); /* Subtle border */
            transition: box-shadow 0.2s ease-in-out;
        }
        .content-card:hover {
             box-shadow: var(--card-shadow-hover, 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)); /* Tailwind shadow-lg */
        }
        /* Ensure last card in a section doesn't have bottom margin */
        .content-section > .content-card:last-child {
            margin-bottom: 0;
        }


        /* --- Fade-in Animation --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in-section {
            opacity: 0;
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* --- Mermaid Diagram Styling --- */
        .mermaid {
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1.5rem; /* mb-6 */
            text-align: center;
            background-color: var(--bg-color-light, #f9fafb);
            padding: 1rem; /* p-4 */
            border-radius: 0.375rem; /* rounded-md */
            border: 1px solid var(--border-color-light, #e5e7eb);
        }
        .mermaid svg { max-width: 100%; height: auto; display: block; margin: auto; }

        /* --- Tooltip Styling (Adapted from example.html) --- */
        .tooltip-term {
            border-bottom: 1px dotted var(--primary-color, #3b82f6);
            cursor: help;
            position: relative;
            color: var(--primary-color-dark, #2563eb);
            font-weight: 500; /* font-medium */
        }
        .tooltip-term::before { /* Tooltip text box */
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px); /* Position above */
            background-color: rgba(31, 41, 55, 0.9); /* bg-gray-800 with opacity */
            color: white;
            padding: 0.4rem 0.75rem; /* p-1.5 px-3 approx */
            border-radius: 4px; /* rounded-sm */
            font-size: 0.8rem; /* text-xs */
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
            z-index: 10;
        }
        .tooltip-term::after { /* Tooltip arrow */
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(0px); /* Position arrow base */
            border-width: 5px;
            border-style: solid;
            border-color: rgba(31, 41, 55, 0.9) transparent transparent transparent; /* Arrow pointing down */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
            z-index: 10;
        }
        .tooltip-term:hover::before,
        .tooltip-term:hover::after {
            opacity: 1;
            visibility: visible;
        }

        /* --- Quiz Card Styling (Adapted from example.html & global.css) --- */
        /* Use .quiz-card styles from global.css if available, otherwise define here */
        .quiz-card {
            background-color: var(--quiz-bg, var(--primary-color-light, #eff6ff));
            border: 1px solid var(--border-color-default, #d1d5db);
            border-left: 4px solid var(--quiz-border-color, var(--primary-color, #3b82f6));
            border-radius: 0.5rem; /* rounded-lg */
            padding: var(--quiz-padding, 1.5rem); /* p-6 */
            margin-top: 2rem; /* Add margin above quiz card mt-8 */
            box-shadow: var(--card-shadow-default, 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1));
        }
        .quiz-question {
            font-size: 1.1rem; /* text-lg */
            font-weight: 500; /* font-medium */
            color: var(--text-color-dark, #1f2937);
            margin-bottom: 1.25rem; /* mb-5 */
            display: flex;
            align-items: center;
        }
        .quiz-question .material-icons {
            margin-right: 0.5rem; /* mr-2 */
            color: var(--primary-color-dark, #2563eb);
        }
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem; /* space-y-3 approx */
            margin-bottom: 1.25rem; /* mb-5 */
        }
        .quiz-option {
            display: flex; /* Use flex for alignment */
            align-items: center;
            padding: 0.75rem 1rem; /* p-3 px-4 */
            border: 1px solid var(--border-color-default, #d1d5db);
            border-radius: 0.375rem; /* rounded-md */
            background-color: var(--bg-color-white, white);
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .quiz-option:hover {
            background-color: var(--quiz-option-hover-bg, rgba(59, 130, 246, 0.1));
            border-color: var(--primary-color, #3b82f6);
        }
        .quiz-option input[type="radio"] {
            margin-right: 0.75rem; /* mr-3 */
            width: 1rem; /* w-4 */
            height: 1rem; /* h-4 */
            accent-color: var(--primary-color, #3b82f6);
            cursor: pointer;
            flex-shrink: 0; /* Prevent radio button from shrinking */
        }
        .quiz-option span { /* Text label */
             flex-grow: 1;
             color: var(--text-color-default, #374151);
             font-size: 0.875rem; /* text-sm */
        }
        .quiz-option.selected {
            border-color: var(--primary-color, #3b82f6);
            background-color: rgba(59, 130, 246, 0.15);
        }
         .quiz-option.correct {
             border-color: var(--success-color, #10b981);
             background-color: var(--success-color-light, #ecfdf5);
         }
         .quiz-option.incorrect {
             border-color: var(--danger-color, #ef4444);
             background-color: var(--danger-color-light, #fee2e2);
         }
        .quiz-feedback {
            margin-top: 1rem; /* mt-4 */
            padding: 0.75rem 1rem; /* p-3 px-4 */
            border-radius: 0.375rem; /* rounded-md */
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            display: none; /* Initially hidden */
        }
        .quiz-feedback.correct {
            background-color: var(--quiz-feedback-correct-bg, var(--success-color-light, #ecfdf5));
            color: var(--quiz-feedback-correct-text, var(--success-color, #10b981));
            border: 1px solid var(--success-color, #10b981);
        }
        .quiz-feedback.incorrect {
            background-color: var(--quiz-feedback-incorrect-bg, var(--danger-color-light, #fee2e2));
            color: var(--quiz-feedback-incorrect-text, var(--danger-color, #ef4444));
            border: 1px solid var(--danger-color, #ef4444);
        }
         .quiz-feedback.warning {
             background-color: var(--warning-color-light, #fff7ed);
             color: var(--warning-color, #f97316);
             border: 1px solid var(--warning-color, #f97316);
         }
        .quiz-toggle { /* Button to check/show answer */
            /* Use button styles from global.css */
            margin-top: 1rem; /* mt-4 */
            position: relative; /* For ripple */
            overflow: hidden; /* For ripple */
        }
        .quiz-toggle .material-icons { /* Arrow icon */
            font-size: 1.1rem;
            transition: transform 0.3s ease-in-out;
            margin-right: 0.25rem; /* Add space between icon and text */
        }
        .quiz-toggle .icon-arrow.rotated {
            transform: rotate(180deg);
        }
        .quiz-answer { /* Collapsible answer section */
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out, padding-top 0.5s ease-in-out, padding-bottom 0.5s ease-in-out, margin-top 0.5s ease-in-out;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
            border: 1px solid var(--border-color-default, #d1d5db);
            background-color: var(--bg-color-lighter, #f3f4f6);
            border-radius: 0.375rem; /* rounded-md */
            color: var(--text-color-default, #374151);
            font-size: 0.875rem; /* text-sm */
        }
        .quiz-answer.visible {
            max-height: 1000px; /* Large enough for content */
            opacity: 1;
            padding-top: 1rem; /* p-4 */
            padding-bottom: 1rem; /* p-4 */
            margin-top: 1rem; /* mt-4 */
            overflow: auto; /* Allow scrolling if needed */
        }
        .quiz-answer p { margin-bottom: 0.5rem; } /* Adjust paragraph spacing inside answer */
        .quiz-answer p:last-child { margin-bottom: 0; }
        .quiz-answer strong { font-weight: 600; } /* font-semibold */

        /* Ripple Effect (Adapted from example.html) */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(var(--primary-color-rgb, 59, 130, 246), 0.4); /* Use RGB var or fallback */
            transform: scale(0);
            animation: ripple-animation 0.6s linear;
            pointer-events: none;
        }
        @keyframes ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }


    </style>
</head>

<body class="bg-gray-100">
    <div class="page-container">

        <aside class="local-side-nav">
            <h4 class="head4">React è¿›é˜¶</h4>
            <ul id="local-toc">
                <li><a href="#intro" class="active"><span class="material-icons nav-icon">category</span>ç®€ä»‹</a></li>
                <li><a href="#context-api"><span class="material-icons nav-icon">account_tree</span>Context API</a></li>
                <li><a href="#common-hooks"><span class="material-icons nav-icon">construction</span>å¸¸ç”¨ Hooks</a></li>
                <li><a href="#virtual-dom"><span class="material-icons nav-icon">view_quilt</span>è™šæ‹Ÿ DOM</a></li>
                <li><a href="#state-management"><span class="material-icons nav-icon">sync_alt</span>çŠ¶æ€ç®¡ç†åº“</a></li>
            </ul>
            <a href="../../index.html" class="back-link"> &larr; è¿”å›å¤§çº²ç›®å½•
            </a>
        </aside>

        <main class="content-main">
            <article>
                <section id="intro" class="content-section fade-in-section" style="animation-delay: 0s;">
                    <h1 class="head1 flex items-center gap-2">
                        <span class="material-icons text-3xl text-blue-600">auto_awesome</span>(äºŒ) React è¿›é˜¶æ¦‚å¿µ (äº†è§£)
                    </h1>
                    <p>æœ¬éƒ¨åˆ†æ¶µç›–äº†ä¸€äº› React çš„è¿›é˜¶æ¦‚å¿µã€‚è™½ç„¶åœ¨é¢è¯•ä¸­å¯èƒ½è¢«æ ‡è®°ä¸ºâ€œä½é¢‘â€æˆ–â€œåŸºç¡€â€ï¼Œä½†ç†è§£è¿™äº›æ¦‚å¿µæœ‰åŠ©äºæ·±å…¥æŒæ¡ React çš„å·¥ä½œåŸç†ï¼Œå¹¶åœ¨ç‰¹å®šåœºæ™¯ä¸‹ç¼–å†™æ›´é«˜æ•ˆã€æ›´å¯ç»´æŠ¤çš„ä»£ç ã€‚</p>
                    <p class="mt-4 bg-blue-50 border-l-4 border-blue-500 text-blue-700 p-4 rounded-md text-sm">ğŸ’¡
                        <strong>æç¤º:</strong> ç‚¹å‡»å·¦ä¾§å¯¼èˆªå¯ä»¥å¿«é€Ÿè·³è½¬åˆ°ç›¸åº”ä¸»é¢˜ã€‚ä»£ç å—æ”¯æŒè¯­æ³•é«˜äº®ã€‚éƒ¨åˆ†æ¦‚å¿µåé™„æœ‰å°æµ‹éªŒå’Œå…³é”®æœ¯è¯­æç¤ºã€‚
                    </p>
                </section>

                <section id="context-api" class="content-section fade-in-section" style="animation-delay: 0.05s;">
                    <h2 class="flex items-center head2">
                        <span class="material-icons">account_tree</span>Context API
                        <span class="level-tag level-tag-low">ä½é¢‘</span>
                        <span class="level-tag level-tag-base">åŸºç¡€</span>
                    </h2>
                    <div class="content-card">
                        <h3 class="head3">åŸºæœ¬æ¦‚å¿µ</h3>
                        <p>Context API æä¾›äº†ä¸€ç§åœ¨ç»„ä»¶æ ‘ä¸­å…±äº«æ•°æ®çš„æ–¹å¼ï¼Œè€Œæ— éœ€æ˜¾å¼åœ°é€šè¿‡ props é€å±‚ä¼ é€’ã€‚</p>
                        <ul class="list-disc list-inside space-y-3 mt-4 text-sm text-gray-700">
                            <li><strong><code>React.createContext(defaultValue)</code>:</strong> åˆ›å»ºä¸€ä¸ª Context å¯¹è±¡ã€‚å½“ React æ¸²æŸ“ä¸€ä¸ªè®¢é˜…äº†è¿™ä¸ª Context å¯¹è±¡çš„ç»„ä»¶ï¼Œå®ƒå°†ä»ç»„ä»¶æ ‘ä¸­ç¦»è‡ªèº«æœ€è¿‘çš„é‚£ä¸ªåŒ¹é…çš„ <code>Provider</code> ä¸­è¯»å–å½“å‰çš„ context å€¼ã€‚å¦‚æœä¸Šå±‚æ²¡æœ‰åŒ¹é…çš„ Providerï¼Œåˆ™ä¼šä½¿ç”¨ <code>defaultValue</code>ã€‚</li>
                            <li><strong><code>Context.Provider</code>:</strong> Provider ç»„ä»¶æ¥æ”¶ä¸€ä¸ª <code>value</code> å±æ€§ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™æ¶ˆè´¹ç»„ä»¶ã€‚ä¸€ä¸ª Provider å¯ä»¥è¢«åµŒå¥—ï¼Œä»¥è¦†ç›–ç»„ä»¶æ ‘å†…æ›´æ·±å±‚æ¬¡çš„å€¼ã€‚æ‰€æœ‰æ¶ˆè´¹ç»„ä»¶éƒ½ä¼šåœ¨ Provider çš„ <code>value</code> å±æ€§å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°æ¸²æŸ“ã€‚</li>
                            <li><strong><code>useContext(MyContext)</code>:</strong> è¿™æ˜¯æ¶ˆè´¹ Context å€¼çš„æœ€å¸¸ç”¨æ–¹å¼ï¼ˆåœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼‰ã€‚å®ƒæ¥æ”¶ Context å¯¹è±¡ï¼ˆ<code>React.createContext</code> çš„è¿”å›å€¼ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›è¯¥ Context çš„å½“å‰å€¼ã€‚<code>useContext</code> çš„å‚æ•°å¿…é¡»æ˜¯ Context å¯¹è±¡æœ¬èº«ã€‚</li>
                        </ul>
                         <div class="mermaid">
                            graph TD
                                A[App Component] -- value --> P(ThemeContext.Provider);
                                P --> B(Toolbar Component);
                                B --> C(ThemedButton Component);
                                C -- reads value via useContext --> P;

                                subgraph "Context Data Flow"
                                    A; P; B; C;
                                end

                                style P fill:#eff6ff,stroke:#60a5fa,stroke-width:2px
                                style C fill:#dbeafe,stroke:#60a5fa
                        </div>
                    </div>
                    <div class="content-card">
                        <h3 class="head3">ä½¿ç”¨åœºæ™¯ï¼šè§£å†³ <span class="tooltip-term" data-tooltip="æŒ‡ä¸ºäº†å°†æ•°æ®ä¼ é€’ç»™æ·±å±‚å­ç»„ä»¶ï¼Œä¸­é—´çš„è®¸å¤šå±‚çº§ç»„ä»¶è¢«è¿«æ¥æ”¶å¹¶ä¼ é€’è¯¥ prop çš„ç°è±¡ã€‚">Prop Drilling</span></h3>
                        <p>æœ€ä¸»è¦çš„åº”ç”¨åœºæ™¯æ˜¯é¿å…â€œå±æ€§é€å±‚ä¼ é€’ (Prop Drilling)â€ã€‚å½“é¡¶å±‚ç»„ä»¶çš„æ•°æ®éœ€è¦ä¼ é€’ç»™å¾ˆæ·±å±‚çº§çš„å­ç»„ä»¶æ—¶ï¼Œä¸­é—´çš„æ¯ä¸€å±‚ç»„ä»¶éƒ½ä¸å¾—ä¸æ¥æ”¶å¹¶å‘ä¸‹ä¼ é€’è¿™ä¸ª propï¼Œå³ä½¿å®ƒä»¬æœ¬èº«å¹¶ä¸éœ€è¦è¿™ä¸ªæ•°æ®ã€‚</p>
                        <p>ä½¿ç”¨ Contextï¼Œä½ å¯ä»¥åœ¨é¡¶å±‚è®¾ç½®ä¸€ä¸ª Providerï¼Œç„¶ååœ¨ä»»ä½•æ·±åº¦çš„å­ç»„ä»¶ä¸­ä½¿ç”¨ <code>useContext</code> ç›´æ¥è·å–æ•°æ®ã€‚</p>
                        <pre><code class="language-javascript">
// 1. åˆ›å»º Context
const ThemeContext = React.createContext('light'); // é»˜è®¤å€¼ 'light'

// 2. App ç»„ä»¶ä¸­ä½¿ç”¨ Provider åŒ…è£¹å­ç»„ä»¶ï¼Œå¹¶ä¼ é€’ value
function App() {
  const [theme, setTheme] = React.useState('dark');

  // å°† theme å’Œ setTheme éƒ½ä¼ å…¥ contextï¼Œä»¥ä¾¿å­ç»„ä»¶å¯ä»¥æ›´æ”¹ä¸»é¢˜
  const contextValue = React.useMemo(() => ({ theme, setTheme }), [theme]);

  return (
    &lt;ThemeContext.Provider value={contextValue}&gt;
      &lt;Toolbar /&gt;
      &lt;ThemeToggler /&gt; {/* æå–åˆ‡æ¢æŒ‰é’® */}
    &lt;/ThemeContext.Provider&gt;
  );
}

// 3. ä¸­é—´ç»„ä»¶ Toolbar (ä¸éœ€è¦å…³å¿ƒ theme)
function Toolbar() {
  // Toolbar ä¸éœ€è¦çŸ¥é“ theme æˆ– setTheme
  return (
    &lt;div className="p-4 border rounded mb-4"&gt;
      &lt;ThemedButton /&gt;
    &lt;/div&gt;
  );
}

// 4. æ·±å±‚å­ç»„ä»¶ ThemedButton ä½¿ç”¨ useContext è·å– theme
function ThemedButton() {
  const { theme } = React.useContext(ThemeContext); // åªè§£æ„éœ€è¦çš„ theme

  const buttonStyle = {
    background: theme === 'dark' ? '#333' : '#eee',
    color: theme === 'dark' ? '#fff' : '#000',
    padding: '10px 20px',
    border: 'none',
    borderRadius: '5px',
    cursor: 'pointer'
  };

  return (
    &lt;button style={buttonStyle}&gt;
      I am styled by theme: {theme}
    &lt;/button&gt;
  );
}

// 5. å¦ä¸€ä¸ªæ¶ˆè´¹ Context çš„ç»„ä»¶ï¼Œç”¨äºåˆ‡æ¢ä¸»é¢˜
function ThemeToggler() {
    const { theme, setTheme } = React.useContext(ThemeContext);
    return (
        &lt;button
            onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}
            className="button button-secondary"
        &gt;
            Toggle Theme (Current: {theme})
        &lt;/button&gt;
    );
}

// æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­éœ€è¦ import React, { useState, useContext, useMemo } ç­‰
// ä½¿ç”¨ useMemo åŒ…è£… contextValue æ˜¯ä¸€ä¸ªä¼˜åŒ–ï¼Œé˜²æ­¢ä¸å¿…è¦çš„ context æ›´æ–°
                        </code></pre>
                        <p class="mt-4 text-sm text-gray-600"><strong>æ³¨æ„ï¼š</strong>Context ä¸»è¦ç”¨äºå…±äº«é‚£äº›è¢«è®¤ä¸ºæ˜¯â€œå…¨å±€â€çš„æ•°æ®ï¼ˆå¦‚ä¸»é¢˜ã€ç”¨æˆ·è®¤è¯çŠ¶æ€ã€è¯­è¨€åå¥½ï¼‰ã€‚å¯¹äºé¢‘ç¹æ›´æ–°çš„çŠ¶æ€ï¼Œæˆ–è€…æ›´å¤æ‚çš„çŠ¶æ€é€»è¾‘ï¼Œä¸“é—¨çš„çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚ Redux, Zustandï¼‰å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸º Context çš„æ›´æ–°é»˜è®¤ä¼šä½¿æ‰€æœ‰æ¶ˆè´¹è¯¥ Context çš„ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼ˆå¯ä»¥é€šè¿‡ `React.memo` ç­‰ä¼˜åŒ–ï¼‰ã€‚ </p>
                    </div>
                    <div class="quiz-card" id="quiz-context">
                        <div class="quiz-question"><span class="material-icons">quiz</span>Context API ä¸»è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</div>
                        <div class="quiz-options">
                            <label class="quiz-option">
                                <input type="radio" name="q_context" value="a">
                                <span>ç»„ä»¶æ€§èƒ½ä¼˜åŒ–</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_context" value="b">
                                <span>é¿å…å±æ€§é€å±‚ä¼ é€’ (Prop Drilling)</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_context" value="c">
                                <span>å¤„ç†å¼‚æ­¥æ“ä½œ</span>
                            </label>
                             <label class="quiz-option">
                                <input type="radio" name="q_context" value="d">
                                <span>ç»„ä»¶ä»£ç å¤ç”¨</span>
                            </label>
                        </div>
                        <div class="quiz-feedback mt-4" id="feedback-q_context"></div>
                        <button class="quiz-toggle button button-secondary" onclick="checkAnswer('q_context', 'b', 'quiz-context')">
                             <span class="material-icons icon-arrow">expand_more</span><span class="button-text">æ£€æŸ¥ç­”æ¡ˆ</span>
                        </button>
                         <div class="quiz-answer">
                            <p><strong>ç­”æ¡ˆ:</strong> B. é¿å…å±æ€§é€å±‚ä¼ é€’ (Prop Drilling)</p>
                            <p><strong>è§£æ:</strong> Context API æœ€æ ¸å¿ƒçš„ç”¨é€”å°±æ˜¯æä¾›ä¸€ç§åœ¨ç»„ä»¶æ ‘ä¸­å…±äº«æ•°æ®çš„æ–¹å¼ï¼Œè€Œæ— éœ€æ‰‹åŠ¨åœ°ä¸€å±‚ä¸€å±‚é€šè¿‡ props ä¼ é€’ï¼Œä»è€Œè§£å†³äº† Prop Drilling çš„é—®é¢˜ã€‚è™½ç„¶å®ƒå¯èƒ½é—´æ¥å½±å“æ€§èƒ½ï¼ˆä¸å½“ä½¿ç”¨æ—¶ï¼‰ï¼Œä½†å…¶ä¸»è¦ç›®çš„ä¸æ˜¯æ€§èƒ½ä¼˜åŒ–ã€‚å¼‚æ­¥æ“ä½œå’Œä»£ç å¤ç”¨é€šå¸¸ç”±å…¶ä»–æ¨¡å¼æˆ– Hooks å¤„ç†ã€‚</p>
                        </div>
                    </div>
                </section>

                <section id="common-hooks" class="content-section fade-in-section" style="animation-delay: 0.1s;">
                    <h2 class="flex items-center head2">
                        <span class="material-icons">construction</span>å…¶ä»–å¸¸ç”¨ Hooks (useMemo, useCallback)
                        <span class="level-tag level-tag-low">ä½é¢‘</span>
                        <span class="level-tag level-tag-base">åŸºç¡€</span>
                    </h2>
                    <div class="content-card">
                        <h3 class="head3">ä½œç”¨ï¼šæ€§èƒ½ä¼˜åŒ–</h3>
                        <p><code>useMemo</code> å’Œ <code>useCallback</code> æ˜¯ React æä¾›çš„ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„ Hooksã€‚å®ƒä»¬çš„æ ¸å¿ƒæœºåˆ¶æ˜¯ <strong class="tooltip-term" data-tooltip="ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œé€šè¿‡ç¼“å­˜å‡½æ•°è°ƒç”¨æˆ–è®¡ç®—çš„ç»“æœï¼Œåœ¨åç»­ç›¸åŒçš„è¾“å…¥æ—¶ç›´æ¥è¿”å›ç¼“å­˜ç»“æœï¼Œé¿å…é‡å¤è®¡ç®—ã€‚">è®°å¿†åŒ– (Memoization)</strong>ï¼Œå³ç¼“å­˜è®¡ç®—ç»“æœæˆ–å‡½æ•°å®ä¾‹ï¼Œé¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ä¸å¿…è¦çš„é‡å¤è®¡ç®—æˆ–åˆ›å»ºã€‚</p>
                    </div>
                    <div class="content-card">
                        <h3 class="head3"><code>useMemo</code></h3>
                        <p><code>useMemo</code> ç”¨äºç¼“å­˜ <strong>è®¡ç®—ç»“æœ</strong>ã€‚</p>
                        <p class="mt-2 text-sm text-gray-700"><code>const memoizedValue = useMemo(() => computeExpensiveValue(a, b), [a, b]);</code></p>
                        <ul class="list-disc list-inside space-y-3 mt-4 text-sm text-gray-700">
                            <li>å®ƒæ¥æ”¶ä¸€ä¸ªâ€œåˆ›å»ºâ€å‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ã€‚</li>
                            <li>åœ¨åˆå§‹æ¸²æŸ“æ—¶ï¼Œä¼šè°ƒç”¨åˆ›å»ºå‡½æ•°ï¼Œç¼“å­˜å…¶è¿”å›å€¼ã€‚</li>
                            <li>åœ¨åç»­æ¸²æŸ“ä¸­ï¼Œåªæœ‰å½“ä¾èµ–é¡¹æ•°ç»„ <code>[a, b]</code> ä¸­çš„æŸä¸ªå€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°æ‰§è¡Œåˆ›å»ºå‡½æ•°å¹¶è¿”å›æ–°å€¼ï¼›å¦åˆ™ï¼Œç›´æ¥è¿”å›ä¸Šä¸€æ¬¡ç¼“å­˜çš„å€¼ã€‚</li>
                            <li><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong> å½“ç»„ä»¶ä¸­æœ‰è®¡ç®—æˆæœ¬è¾ƒé«˜çš„æ“ä½œï¼ˆå¦‚å¤æ‚çš„æ•°æ®ç­›é€‰ã€æ’åºã€è½¬æ¢ï¼‰æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>useMemo</code> é¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½é‡æ–°è®¡ç®—ï¼Œå‰ææ˜¯è®¡ç®—çš„ä¾èµ–é¡¹æ²¡æœ‰æ”¹å˜ã€‚</li>
                        </ul>
                        <pre><code class="language-javascript">
import React, { useState, useMemo } from 'react';

function ExpensiveCalculationComponent({ list, filter }) {
  // å‡è®¾ filterList æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œ
  const filterList = (list, filter) => {
    console.log('%cFiltering list...', 'color: orange; font-weight: bold;'); // è§‚å¯Ÿä½•æ—¶æ‰§è¡Œ
    // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    // let startTime = performance.now();
    // while (performance.now() - startTime < 500) { /* busy wait */ }
    return list.filter(item => item.toLowerCase().includes(filter.toLowerCase()));
  };

  // ä½¿ç”¨ useMemo ç¼“å­˜è¿‡æ»¤ç»“æœ
  // åªæœ‰å½“ list æˆ– filter å˜åŒ–æ—¶ï¼ŒfilterList æ‰ä¼šé‡æ–°æ‰§è¡Œ
  const visibleList = useMemo(() => filterList(list, filter), [list, filter]);

  return (
    &lt;div className="mt-4 p-4 border rounded bg-gray-50"&gt;
      &lt;h4 className="font-semibold mb-2"&gt;Filtered List (Memoized):&lt;/h4&gt;
      &lt;ul className="list-disc list-inside text-sm"&gt;
        {visibleList.map((item, index) => (
          &lt;li key={index}&gt;{item}&lt;/li&gt;
        ))}
        {visibleList.length === 0 && &lt;li className="text-gray-500"&gt;No items match.&lt;/li&gt;}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}

function App() {
  const [list, setList] = useState(['Apple', 'Banana', 'Orange', 'Avocado']);
  const [filter, setFilter] = useState('');
  const [counter, setCounter] = useState(0); // ä¸€ä¸ªæ— å…³çš„çŠ¶æ€ï¼Œç”¨äºè§¦å‘ App é‡æ¸²æŸ“

  console.log('%cApp Rendering...', 'color: lightblue;');

  return (
    &lt;div&gt;
      &lt;input
        type="text"
        placeholder="Filter list"
        value={filter}
        onChange={(e) => setFilter(e.target.value)}
        className="border p-2 rounded mr-2 mb-2"
      /&gt;
      &lt;button onClick={() => setCounter(c => c + 1)} className="button button-secondary mb-2"&gt;
        Force Re-render App (Counter: {counter})
      &lt;/button&gt;
      {/* å³ä½¿ App å›  counter å˜åŒ–è€Œé‡æ¸²æŸ“, åªè¦ list å’Œ filter ä¸å˜, */}
      {/* ExpensiveCalculationComponent ä¸­çš„ useMemo å°±ä¸ä¼šé‡æ–°è®¡ç®— filterList */}
      &lt;ExpensiveCalculationComponent list={list} filter={filter} /&gt;
      &lt;p className="text-xs mt-2 text-gray-500"&gt;æ‰“å¼€æ§åˆ¶å°è§‚å¯Ÿ 'Filtering list...' çš„æ‰“å°é¢‘ç‡ã€‚&lt;/p&gt;
    &lt;/div&gt;
  );
}
// éœ€è¦ import React, useState, useMemo
                        </code></pre>
                    </div>
                    <div class="content-card">
                        <h3 class="head3"><code>useCallback</code></h3>
                        <p><code>useCallback</code> ç”¨äºç¼“å­˜ <strong>å‡½æ•°å®ä¾‹</strong>ã€‚</p>
                        <p class="mt-2 text-sm text-gray-700"><code>const memoizedCallback = useCallback(() => { doSomething(a, b); }, [a, b]);</code></p>
                        <ul class="list-disc list-inside space-y-3 mt-4 text-sm text-gray-700">
                            <li>å®ƒæ¥æ”¶ä¸€ä¸ªå†…è”å›è°ƒå‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ã€‚</li>
                            <li>è¿”å›è¯¥å›è°ƒå‡½æ•°çš„è®°å¿†åŒ–ç‰ˆæœ¬ã€‚è¿™ä¸ªè®°å¿†åŒ–ç‰ˆæœ¬åªæœ‰åœ¨ä¾èµ–é¡¹æ•°ç»„ <code>[a, b]</code> ä¸­çš„æŸä¸ªå€¼å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šæ›´æ–°ã€‚</li>
                            <li><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong> ä¸»è¦ç”¨åœ¨å°†å›è°ƒå‡½æ•°ä½œä¸º prop ä¼ é€’ç»™å­ç»„ä»¶æ—¶ï¼Œç‰¹åˆ«æ˜¯å½“å­ç»„ä»¶ä½¿ç”¨äº† <strong class="tooltip-term" data-tooltip="ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œç”¨äºä¼˜åŒ–å‡½æ•°ç»„ä»¶ã€‚å®ƒä¼šå¯¹ props è¿›è¡Œæµ…æ¯”è¾ƒï¼Œåªæœ‰ props å˜åŒ–æ—¶æ‰é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚"><code>React.memo</code></strong> æˆ–ä¾èµ–äº prop çš„å¼•ç”¨ç›¸ç­‰æ€§è¿›è¡Œä¼˜åŒ–æ—¶ã€‚å¦‚æœä¸ä½¿ç”¨ <code>useCallback</code>ï¼Œçˆ¶ç»„ä»¶æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ï¼Œå³ä½¿å‡½æ•°é€»è¾‘ä¸å˜ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´å­ç»„ä»¶è®¤ä¸º prop å˜åŒ–è€Œé‡æ–°æ¸²æŸ“ã€‚<code>useCallback</code> ç¡®ä¿åœ¨ä¾èµ–ä¸å˜çš„æƒ…å†µä¸‹ï¼Œä¼ é€’ç»™å­ç»„ä»¶çš„æ˜¯åŒä¸€ä¸ªå‡½æ•°å®ä¾‹ã€‚</li>
                        </ul>
                         <pre><code class="language-javascript">
import React, { useState, useCallback } from 'react';

// å­ç»„ä»¶ï¼Œä½¿ç”¨ React.memo è¿›è¡Œä¼˜åŒ–
// åªæœ‰ props å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šé‡æ–°æ¸²æŸ“
const MemoizedButton = React.memo(({ onClick, children }) => {
  console.log(`%cRendering Button: ${children}`, 'color: lightgreen;');
  return &lt;button onClick={onClick} className="button button-primary mr-2 mb-2"&gt;{children}&lt;/button&gt;;
});

function ParentComponent() {
  const [count1, setCount1] = useState(0);
  const [count2, setCount2] = useState(0);

  console.log('%cParentComponent Rendering...', 'color: pink;');

  // ä½¿ç”¨ useCallback ç¼“å­˜ handleClick1
  // ä¾èµ–é¡¹ä¸ºç©ºæ•°ç»„ [], å®ƒåªä¼šåœ¨åˆå§‹æ¸²æŸ“æ—¶åˆ›å»ºä¸€æ¬¡
  const handleClick1 = useCallback(() => {
    setCount1(c => c + 1);
    console.log('handleClick1 (memoized) called');
  }, []); // ä¾èµ–é¡¹ä¸ºç©ºï¼Œå‡½æ•°å¼•ç”¨æ°¸ä¸æ”¹å˜

  // æ²¡æœ‰ä½¿ç”¨ useCallback
  // æ¯æ¬¡ ParentComponent æ¸²æŸ“æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ handleClick2 å‡½æ•°å®ä¾‹
  const handleClick2 = () => {
    setCount2(c => c + 1);
    console.log('handleClick2 (new instance) called');
  };

  return (
    &lt;div&gt;
      &lt;p className="mb-2"&gt;Count 1 (updated by memoized callback): {count1}&lt;/p&gt;
      &lt;p className="mb-4"&gt;Count 2 (updated by new callback instance): {count2}&lt;/p&gt;
      {/* ä¼ é€’ç¼“å­˜çš„å›è°ƒ */}
      &lt;MemoizedButton onClick={handleClick1}&gt;Increment Count 1&lt;/MemoizedButton&gt;
      {/* ä¼ é€’æœªç¼“å­˜çš„å›è°ƒ */}
      &lt;MemoizedButton onClick={handleClick2}&gt;Increment Count 2&lt;/MemoizedButton&gt;
      &lt;p className="text-xs mt-2 text-gray-500"&gt;
        æ‰“å¼€æ§åˆ¶å°è§‚å¯ŸæŒ‰é’®çš„æ¸²æŸ“æ—¥å¿—ã€‚ç‚¹å‡» Count 1 æŒ‰é’®ï¼Œåªæœ‰ Button 1 æ—¥å¿—ï¼ˆé¦–æ¬¡ç‚¹å‡»æ—¶ï¼‰å’Œ Parent æ—¥å¿—ã€‚ç‚¹å‡» Count 2 æŒ‰é’®ï¼ŒParent å’Œ Button 2 éƒ½ä¼šæ‰“å°æ¸²æŸ“æ—¥å¿—ï¼Œå› ä¸º handleClick2 æ˜¯æ–°å®ä¾‹ã€‚
      &lt;/p&gt;
    &lt;/div&gt;
  );
}
// éœ€è¦ import React, useState, useCallback
                        </code></pre>
                        <p class="mt-4 text-sm text-gray-600"><strong>é‡è¦æç¤ºï¼š</strong> ä¸è¦è¿‡åº¦ä½¿ç”¨ <code>useMemo</code> å’Œ <code>useCallback</code>ã€‚å®ƒä»¬æœ¬èº«ä¹Ÿæœ‰å¼€é”€ï¼ˆåˆ›å»ºä¾èµ–é¡¹æ•°ç»„ã€æ¯”è¾ƒä¾èµ–é¡¹ï¼‰ã€‚åªæœ‰åœ¨ç¡®å®å­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Œæˆ–è€…éœ€è¦ä¿è¯å¼•ç”¨ç›¸ç­‰æ€§ï¼ˆå¦‚ä¼ é€’ç»™ä¼˜åŒ–å­ç»„ä»¶çš„å›è°ƒï¼‰æ—¶æ‰ä½¿ç”¨å®ƒä»¬ã€‚è¿‡æ—©æˆ–ä¸å¿…è¦çš„ä¼˜åŒ–å¯èƒ½ä¼šå¢åŠ ä»£ç å¤æ‚åº¦ã€‚</p>
                    </div>
                     <div class="quiz-card" id="quiz-hooks">
                        <div class="quiz-question"><span class="material-icons">quiz</span><code>useCallback</code> ä¸»è¦ç”¨äºä¼˜åŒ–ä»€ä¹ˆåœºæ™¯ï¼Ÿ</div>
                        <div class="quiz-options">
                            <label class="quiz-option">
                                <input type="radio" name="q_hooks" value="a">
                                <span>ç¼“å­˜å¤æ‚çš„è®¡ç®—ç»“æœ</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_hooks" value="b">
                                <span>åœ¨ç»„ä»¶å¸è½½æ—¶æ‰§è¡Œæ¸…ç†æ“ä½œ</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_hooks" value="c">
                                <span>å‘ä¼˜åŒ–è¿‡çš„å­ç»„ä»¶ä¼ é€’å›è°ƒå‡½æ•°æ—¶ï¼Œä¿æŒå‡½æ•°å¼•ç”¨çš„ç¨³å®šæ€§</span>
                            </label>
                             <label class="quiz-option">
                                <input type="radio" name="q_hooks" value="d">
                                <span>åˆ›å»ºå¯å˜çš„ ref å¯¹è±¡</span>
                            </label>
                        </div>
                        <div class="quiz-feedback mt-4" id="feedback-q_hooks"></div>
                        <button class="quiz-toggle button button-secondary" onclick="checkAnswer('q_hooks', 'c', 'quiz-hooks')">
                             <span class="material-icons icon-arrow">expand_more</span><span class="button-text">æ£€æŸ¥ç­”æ¡ˆ</span>
                        </button>
                         <div class="quiz-answer">
                            <p><strong>ç­”æ¡ˆ:</strong> C. å‘ä¼˜åŒ–è¿‡çš„å­ç»„ä»¶ä¼ é€’å›è°ƒå‡½æ•°æ—¶ï¼Œä¿æŒå‡½æ•°å¼•ç”¨çš„ç¨³å®šæ€§</p>
                            <p><strong>è§£æ:</strong> <code>useCallback</code> çš„æ ¸å¿ƒä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªè®°å¿†åŒ–çš„å›è°ƒå‡½æ•°ç‰ˆæœ¬ã€‚è¿™åœ¨å°†å›è°ƒä½œä¸º prop ä¼ é€’ç»™ä½¿ç”¨ <code>React.memo</code> ä¼˜åŒ–çš„å­ç»„ä»¶æ—¶å°¤å…¶é‡è¦ï¼Œå¯ä»¥é˜²æ­¢å› ä¸ºçˆ¶ç»„ä»¶æ¸²æŸ“å¯¼è‡´å›è°ƒå‡½æ•°å®ä¾‹å˜åŒ–ï¼Œä»è€Œé¿å…å­ç»„ä»¶ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚A æ˜¯ <code>useMemo</code> çš„åœºæ™¯ï¼ŒB æ˜¯ <code>useEffect</code> çš„æ¸…ç†å‡½æ•°åœºæ™¯ï¼ŒD æ˜¯ <code>useRef</code> çš„åœºæ™¯ã€‚</p>
                        </div>
                    </div>
                </section>

                <section id="virtual-dom" class="content-section fade-in-section" style="animation-delay: 0.15s;">
                    <h2 class="flex items-center head2">
                        <span class="material-icons">view_quilt</span>è™šæ‹Ÿ DOM (Virtual DOM)
                        <span class="level-tag level-tag-low">ä½é¢‘</span>
                        <span class="level-tag level-tag-base">åŸºç¡€</span>
                    </h2>
                    <div class="content-card">
                        <h3 class="head3">åŸºæœ¬æ¦‚å¿µ</h3>
                        <p>è™šæ‹Ÿ DOM (VDOM) æ˜¯çœŸå® DOM çš„ä¸€ä¸ªè½»é‡çº§ã€å†…å­˜ä¸­çš„è¡¨ç¤ºã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œæè¿°äº† UI çš„ç»“æ„ã€å±æ€§å’Œå†…å®¹ã€‚</p>
                        <p>React çš„å·¥ä½œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
                        <ol class="list-decimal list-inside space-y-2 mt-4 text-sm text-gray-700">
                            <li>å½“ç»„ä»¶çš„ state æˆ– props å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒReact ä¼šæ ¹æ®æ–°çš„çŠ¶æ€é‡æ–°è®¡ç®—å¹¶åˆ›å»ºä¸€ä¸ª <strong>æ–°çš„è™šæ‹Ÿ DOM æ ‘</strong>ã€‚</li>
                            <li>React å°†è¿™ä¸ªæ–°çš„ VDOM æ ‘ä¸ä¸Šä¸€æ¬¡æ¸²æŸ“ç”Ÿæˆçš„æ—§ VDOM æ ‘è¿›è¡Œæ¯”è¾ƒï¼ˆè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º <strong class="tooltip-term" data-tooltip="ä¹Ÿç§°ä¸º Diffingï¼Œæ˜¯æ¯”è¾ƒä¸¤æ£µè™šæ‹Ÿ DOM æ ‘ï¼Œæ‰¾å‡ºæœ€å°å·®å¼‚çš„è¿‡ç¨‹ï¼Œæ˜¯ React é«˜æ•ˆæ›´æ–° UI çš„å…³é”®ã€‚">Reconciliation</strong>ï¼‰ã€‚</li>
                            <li>é€šè¿‡ Diffing ç®—æ³•ï¼ŒReact æ‰¾å‡ºä¸¤æ£µæ ‘ä¹‹é—´çš„æœ€å°å·®å¼‚ï¼ˆéœ€è¦æ›´æ–°ã€æ·»åŠ æˆ–åˆ é™¤çš„èŠ‚ç‚¹ï¼‰ã€‚</li>
                            <li>React å°†è¿™äº›è®¡ç®—å‡ºçš„å·®å¼‚è¿›è¡Œ <strong class="tooltip-term" data-tooltip="React ä¼šå°†å¤šä¸ªçŠ¶æ€æ›´æ–°åˆå¹¶åˆ°ä¸€æ¬¡æ¸²æŸ“ä¸­è¿›è¡Œå¤„ç†ï¼Œä»¥æé«˜æ€§èƒ½ï¼Œå‡å°‘ä¸å¿…è¦çš„ DOM æ“ä½œã€‚">æ‰¹é‡æ›´æ–° (Batching)</strong>ï¼Œç„¶åä¸€æ¬¡æ€§åœ°ã€é«˜æ•ˆåœ°åº”ç”¨åˆ° <strong>çœŸå®çš„ DOM</strong> ä¸Šã€‚</li>
                        </ol>
                        <div class="mermaid">
                            graph TD
                                A[State/Props Change] --> B(Render Component);
                                B --> C{New Virtual DOM Tree};
                                C -- Diffing Algorithm (Reconciliation) --> D(Compare with Old VDOM);
                                D --> E{Calculate Minimal Changes};
                                E -- Batching --> F[Update Real DOM];

                                subgraph React Reconciliation Process
                                    B; C; D; E; F;
                                end

                                style A fill:#fffbeb,stroke:#d97706
                                style F fill:#dcfce7,stroke:#16a34a
                                style D fill:#e0f2fe,stroke:#0ea5e9
                        </div>
                    </div>
                     <div class="content-card">
                        <h3 class="head3">ä¼˜åŠ¿</h3>
                        <ul class="list-disc list-inside space-y-3 mt-4 text-sm text-gray-700">
                            <li><strong>æ€§èƒ½æå‡ï¼š</strong> ç›´æ¥æ“ä½œçœŸå® DOM çš„æˆæœ¬å¾ˆé«˜ï¼ˆæ¶‰åŠé‡æ’ Reflow å’Œé‡ç»˜ Repaintï¼‰ã€‚VDOM é€šè¿‡ Diffing å’Œ Batchingï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘äº†å¯¹çœŸå® DOM çš„æ“ä½œæ¬¡æ•°å’ŒèŒƒå›´ï¼Œä»è€Œæé«˜äº† UI æ›´æ–°æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚åº”ç”¨ä¸­ã€‚</li>
                            <li><strong>æŠ½è±¡åŒ–ï¼š</strong> VDOM ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªå£°æ˜å¼çš„ç¼–ç¨‹æ¨¡å‹ã€‚å¼€å‘è€…åªéœ€å…³å¿ƒ UI åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼ˆåŸºäºå½“å‰çŠ¶æ€ï¼‰ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–å†™ç¹ççš„ DOM æ“ä½œä»£ç ã€‚React è´Ÿè´£å°†å£°æ˜è½¬æ¢ä¸ºå®é™…çš„ DOM æ›´æ–°ã€‚</li>
                            <li><strong>è·¨å¹³å°èƒ½åŠ›ï¼š</strong> VDOM çš„æ¦‚å¿µä½¿å¾— React ä¸ä»…ä»…å±€é™äºæµè§ˆå™¨ã€‚ä¾‹å¦‚ï¼ŒReact Native åˆ©ç”¨ç±»ä¼¼çš„åŸç†ï¼Œå°† React ç»„ä»¶æ¸²æŸ“æˆåŸç”Ÿç§»åŠ¨åº”ç”¨ç•Œé¢ï¼ˆiOS/Androidï¼‰ï¼Œè€Œä¸æ˜¯ DOMã€‚</li>
                        </ul>
                    </div>
                     <div class="quiz-card" id="quiz-vdom">
                        <div class="quiz-question"><span class="material-icons">quiz</span>è™šæ‹Ÿ DOM çš„ä¸»è¦ä¼˜åŠ¿ä¸åŒ…æ‹¬ä»¥ä¸‹å“ªé¡¹ï¼Ÿ</div>
                        <div class="quiz-options">
                            <label class="quiz-option">
                                <input type="radio" name="q_vdom" value="a">
                                <span>é€šè¿‡ Diffing å’Œ Batching æå‡æ€§èƒ½</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_vdom" value="b">
                                <span>æä¾›å£°æ˜å¼ç¼–ç¨‹æ¨¡å‹ï¼Œç®€åŒ–å¼€å‘</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_vdom" value="c">
                                <span>ç›´æ¥æ“ä½œç¡¬ä»¶èµ„æº</span>
                            </label>
                             <label class="quiz-option">
                                <input type="radio" name="q_vdom" value="d">
                                <span>æœ‰åŠ©äºå®ç°è·¨å¹³å°æ¸²æŸ“ (å¦‚ React Native)</span>
                            </label>
                        </div>
                        <div class="quiz-feedback mt-4" id="feedback-q_vdom"></div>
                        <button class="quiz-toggle button button-secondary" onclick="checkAnswer('q_vdom', 'c', 'quiz-vdom')">
                             <span class="material-icons icon-arrow">expand_more</span><span class="button-text">æ£€æŸ¥ç­”æ¡ˆ</span>
                        </button>
                         <div class="quiz-answer">
                            <p><strong>ç­”æ¡ˆ:</strong> C. ç›´æ¥æ“ä½œç¡¬ä»¶èµ„æº</p>
                            <p><strong>è§£æ:</strong> è™šæ‹Ÿ DOM æ˜¯ä¸€ä¸ªå†…å­˜ä¸­çš„ JavaScript å¯¹è±¡è¡¨ç¤ºï¼Œå®ƒæŠ½è±¡äº†çœŸå®çš„ DOM æ“ä½œï¼Œä½†å®ƒæœ¬èº«å¹¶ä¸ç›´æ¥æ“ä½œç¡¬ä»¶èµ„æºã€‚ç¡¬ä»¶æ“ä½œæ˜¯ç”±æµè§ˆå™¨æˆ–æ“ä½œç³»ç»Ÿå†…æ ¸è´Ÿè´£çš„ã€‚æ€§èƒ½æå‡ã€å£°æ˜å¼ç¼–ç¨‹å’Œè·¨å¹³å°èƒ½åŠ›æ˜¯ VDOM çš„ä¸»è¦ä¼˜åŠ¿ã€‚</p>
                        </div>
                    </div>
                </section>

                <section id="state-management" class="content-section fade-in-section" style="animation-delay: 0.2s;">
                    <h2 class="flex items-center head2">
                        <span class="material-icons">sync_alt</span>çŠ¶æ€ç®¡ç†åº“ (Redux/Zustand ç­‰)
                        <span class="level-tag level-tag-low">ä½é¢‘</span>
                        <span class="level-tag level-tag-base">åŸºç¡€</span>
                    </h2>
                    <div class="content-card">
                        <h3 class="head3">å­˜åœ¨å’Œç›®çš„</h3>
                        <p>éšç€åº”ç”¨è§„æ¨¡çš„å¢é•¿å’Œå¤æ‚åº¦çš„æé«˜ï¼Œç»„ä»¶é—´å…±äº«çŠ¶æ€çš„éœ€æ±‚ä¼šè¶Šæ¥è¶Šå¤šï¼ŒçŠ¶æ€çš„æ¥æºå’Œæ›´æ–°é€»è¾‘ä¹Ÿå¯èƒ½å˜å¾—åˆ†æ•£å’Œéš¾ä»¥è¿½è¸ªã€‚ä»…ä»…ä¾é ç»„ä»¶è‡ªèº«çš„ state (`useState`) æˆ– Context API å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š</p>
                         <ul class="list-disc list-inside space-y-2 mt-4 text-sm text-gray-700">
                             <li><strong>æ·±åº¦ Prop Drillingï¼š</strong> çŠ¶æ€éœ€è¦è·¨è¶Šå¾ˆå¤šå±‚çº§ä¼ é€’ã€‚</li>
                             <li><strong>çŠ¶æ€æ¥æºä¸æ¸…æ™°ï¼š</strong> éš¾ä»¥è¿½è¸ªæŸä¸ªçŠ¶æ€æ˜¯åœ¨å“ªé‡Œè¢«ä¿®æ”¹çš„ã€‚</li>
                             <li><strong>é€»è¾‘åˆ†æ•£ï¼š</strong> æ›´æ–°åŒä¸€çŠ¶æ€çš„é€»è¾‘å¯èƒ½æ•£å¸ƒåœ¨å¤šä¸ªç»„ä»¶ä¸­ã€‚</li>
                             <li><strong>ç»„ä»¶é—´é€šä¿¡å¤æ‚ï¼š</strong> éçˆ¶å­å…³ç³»çš„ç»„ä»¶å…±äº«çŠ¶æ€æ¯”è¾ƒå›°éš¾ã€‚</li>
                         </ul>
                         <p>çŠ¶æ€ç®¡ç†åº“æ—¨åœ¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæä¾›ä¸€ç§ <strong>é›†ä¸­å¼ã€å¯é¢„æµ‹ã€æ˜“äºç»´æŠ¤</strong> çš„æ–¹å¼æ¥ç®¡ç†åº”ç”¨çš„å…¨å±€æˆ–å…±äº«çŠ¶æ€ã€‚</p>
                         <p><strong>æ ¸å¿ƒç›®çš„ï¼š</strong></p>
                         <ul class="list-disc list-inside space-y-2 mt-4 text-sm text-gray-700">
                            <li><strong>é›†ä¸­ç®¡ç† (Centralized):</strong> å°†å…±äº«çŠ¶æ€ä»ç»„ä»¶ä¸­æŠ½ç¦»ï¼Œç»Ÿä¸€å­˜æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼ˆStoreï¼‰ã€‚</li>
                            <li><strong>å¯é¢„æµ‹æ€§ (Predictable):</strong> é€šå¸¸å¼ºåˆ¶ä½¿ç”¨ç‰¹å®šçš„æ¨¡å¼æ¥æ›´æ–°çŠ¶æ€ï¼ˆå¦‚ Redux çš„ Action -> Reducerï¼‰ï¼Œä½¿çŠ¶æ€å˜åŒ–æ›´å®¹æ˜“è¿½è¸ªã€è°ƒè¯•å’Œæµ‹è¯•ã€‚</li>
                            <li><strong>è§£è€¦ (Decoupled):</strong> ç»„ä»¶è´Ÿè´£æ¸²æŸ“ UI å’Œè§¦å‘çŠ¶æ€å˜æ›´çš„æ„å›¾ï¼ŒçŠ¶æ€ç®¡ç†é€»è¾‘ç”±åº“å¤„ç†ï¼Œé™ä½ç»„ä»¶å¤æ‚åº¦ã€‚</li>
                            <li><strong>æ˜“äºå…±äº« (Shareable):</strong> åº”ç”¨ä¸­çš„ä»»ä½•ç»„ä»¶éƒ½å¯ä»¥æ–¹ä¾¿åœ°è®¿é—®å’Œå“åº”å…±äº«çŠ¶æ€çš„å˜åŒ–ã€‚</li>
                        </ul>
                    </div>
                    <div class="content-card">
                        <h3 class="head3">äº†è§£ Redux / Zustand</h3>
                         <ul class="list-disc list-inside space-y-3 mt-4 text-sm text-gray-700">
                            <li><strong>Redux:</strong>
                                <ul class="list-['-_'] list-inside ml-4 mt-2 space-y-1 text-xs text-gray-600">
                                    <li>ç»å…¸ã€åŠŸèƒ½å¼ºå¤§çš„çŠ¶æ€ç®¡ç†åº“ï¼ŒåŸºäº Flux æ€æƒ³ã€‚</li>
                                    <li>æ ¸å¿ƒæ¦‚å¿µï¼š<strong>Store</strong> (å•ä¸€æ•°æ®æº), <strong>Action</strong> (æè¿°äº‹ä»¶çš„å¯¹è±¡), <strong>Reducer</strong> (æ ¹æ® Action æ›´æ–°çŠ¶æ€çš„ <span class="tooltip-term" data-tooltip="æŒ‡ç»™å®šç›¸åŒçš„è¾“å…¥ï¼Œæ€»æ˜¯è¿”å›ç›¸åŒçš„è¾“å‡ºï¼Œå¹¶ä¸”ä¸äº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ï¼ˆå¦‚ä¿®æ”¹å¤–éƒ¨å˜é‡ã€å‘èµ·ç½‘ç»œè¯·æ±‚ç­‰ï¼‰çš„å‡½æ•°ã€‚">çº¯å‡½æ•°</span>)ã€‚</li>
                                    <li>å¼ºè°ƒ <span class="tooltip-term" data-tooltip="æŒ‡ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½è¢«ä¿®æ”¹çš„æ•°æ®ã€‚åœ¨ Redux ä¸­ï¼ŒçŠ¶æ€æ›´æ–°æ€»æ˜¯é€šè¿‡åˆ›å»ºæ–°çš„çŠ¶æ€å¯¹è±¡è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹æ—§å¯¹è±¡æ¥å®Œæˆã€‚">ä¸å¯å˜æ€§ (Immutability)</span> å’Œçº¯å‡½æ•°ã€‚</li>
                                    <li>è¿‡å»å› æ ·æ¿ä»£ç ï¼ˆBoilerplateï¼‰è¾ƒå¤šè€Œé—»åï¼Œä½†ç°åœ¨å®˜æ–¹æ¨èçš„ <strong>Redux Toolkit (RTK)</strong> å¤§å¤§ç®€åŒ–äº†ä½¿ç”¨ã€‚</li>
                                    <li>ç”Ÿæ€æˆç†Ÿï¼Œè°ƒè¯•å·¥å…·å¼ºå¤§ã€‚</li>
                                </ul>
                                <div class="mermaid">
                                    graph LR
                                        A[UI Component] -- Dispatch --> B(Action);
                                        B -- Processed by --> C{"Reducer (Pure Function)"};
                                        C -- Updates --> D((Store));
                                        D -- State --> A;

                                    subgraph Redux Basic Flow
                                        A; B; C; D;
                                    end

                                    style A fill:#dbeafe,stroke:#60a5fa
                                    style B fill:#ffedd5,stroke:#fb923c
                                    style C fill:#fef9c3,stroke:#facc15
                                    style D fill:#fce7f3,stroke:#f472b6,stroke-width:2px
                                </div>
                            </li>
                             <li><strong>Zustand:</strong>
                                <ul class="list-['-_'] list-inside ml-4 mt-2 space-y-1 text-xs text-gray-600">
                                    <li>ä¸€ä¸ªæ›´ç°ä»£ã€è½»é‡ã€ç®€æ´çš„çŠ¶æ€ç®¡ç†åº“ã€‚</li>
                                    <li>åŸºäº Hooksï¼ŒAPI éå¸¸ç›´è§‚ï¼Œæ ·æ¿ä»£ç æå°‘ã€‚</li>
                                    <li>ä¸å¼ºåˆ¶ä½¿ç”¨ Reducer æ¨¡å¼ï¼ˆä½†æ”¯æŒï¼‰ï¼Œæä¾›äº†æ›´çµæ´»çš„æ–¹å¼æ¥ç»„ç»‡çŠ¶æ€å’Œæ›´æ–°é€»è¾‘ï¼ˆé€šå¸¸é€šè¿‡ `set` å‡½æ•°ç›´æ¥æ›´æ–°ï¼‰ã€‚</li>
                                    <li>ä¸Šæ‰‹å¿«ï¼Œå¿ƒæ™ºè´Ÿæ‹…å°ï¼Œé€‚ç”¨äºå„ç§è§„æ¨¡çš„é¡¹ç›®ï¼Œå°¤å…¶å—ä¸å–œæ¬¢ Redux å¤æ‚æ€§çš„å¼€å‘è€…æ¬¢è¿ã€‚</li>
                                </ul>
                                <div class="mermaid">
                                    graph LR
                                    A[UI Component] -- Calls action --> B{"Store Hook (useStore)"};
                                    B -- "Uses 'set' function" --> C((Store State));
                                    C -- Selects state --> A;
                                
                                    subgraph Zustand Basic Flow Simplified
                                        A
                                        B
                                        C
                                    end
                                
                                    style A fill:#dbeafe,stroke:#60a5fa
                                    style B fill:#ecfdf5,stroke:#34d399
                                    style C fill:#f1f5f9,stroke:#64748b,stroke-width:2px
                                
                                </div>
                            </li>
                        </ul>
                        <p class="mt-4 text-sm text-gray-600"><strong>é¢è¯•è¦ç‚¹ï¼š</strong> ç†è§£ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†åº“ï¼ˆè§£å†³ä»€ä¹ˆé—®é¢˜ï¼‰ï¼ŒçŸ¥é“ Redux å’Œ Zustand æ˜¯å¸¸è§çš„é€‰æ‹©ï¼Œå¹¶å¤§è‡´äº†è§£å®ƒä»¬çš„æ ¸å¿ƒæ€æƒ³æˆ–ç‰¹ç‚¹ï¼ˆRedux çš„ Action/Reducerï¼ŒZustand çš„ç®€æ´/Hook ê¸°ë°˜ï¼‰ã€‚é‡ç‚¹åœ¨äºç†è§£é—®é¢˜åŸŸå’Œè§£å†³æ–¹æ¡ˆï¼Œè€Œéç²¾é€šæ‰€æœ‰åº“çš„ç»†èŠ‚ï¼ˆé™¤éèŒä½ç‰¹åˆ«è¦æ±‚ï¼‰ã€‚</p>
                    </div>
                     <div class="quiz-card" id="quiz-state">
                        <div class="quiz-question"><span class="material-icons">quiz</span>ä¸ Context API ç›¸æ¯”ï¼ŒçŠ¶æ€ç®¡ç†åº“ (å¦‚ Redux) é€šå¸¸æ›´é€‚åˆå“ªç§åœºæ™¯ï¼Ÿ</div>
                        <div class="quiz-options">
                            <label class="quiz-option">
                                <input type="radio" name="q_state" value="a">
                                <span>ä»…ç”¨äºä¼ é€’ç®€å•çš„ UI ä¸»é¢˜</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_state" value="b">
                                <span>å¤„ç†éå¸¸ç®€å•ã€ç»„ä»¶å±€éƒ¨åŒ–çš„çŠ¶æ€</span>
                            </label>
                            <label class="quiz-option">
                                <input type="radio" name="q_state" value="c">
                                <span>ç®¡ç†å¤æ‚ã€é¢‘ç¹æ›´æ–°ã€è·¨ç»„ä»¶å…±äº«çš„å…¨å±€åº”ç”¨çŠ¶æ€</span>
                            </label>
                             <label class="quiz-option">
                                <input type="radio" name="q_state" value="d">
                                <span>æ›¿ä»£æ‰€æœ‰ useState çš„ä½¿ç”¨</span>
                            </label>
                        </div>
                        <div class="quiz-feedback mt-4" id="feedback-q_state"></div>
                        <button class="quiz-toggle button button-secondary" onclick="checkAnswer('q_state', 'c', 'quiz-state')">
                             <span class="material-icons icon-arrow">expand_more</span><span class="button-text">æ£€æŸ¥ç­”æ¡ˆ</span>
                        </button>
                         <div class="quiz-answer">
                            <p><strong>ç­”æ¡ˆ:</strong> C. ç®¡ç†å¤æ‚ã€é¢‘ç¹æ›´æ–°ã€è·¨ç»„ä»¶å…±äº«çš„å…¨å±€åº”ç”¨çŠ¶æ€</p>
                            <p><strong>è§£æ:</strong> çŠ¶æ€ç®¡ç†åº“æä¾›äº†æ›´å¼ºå¤§çš„åŠŸèƒ½æ¥å¤„ç†å¤æ‚çš„çŠ¶æ€é€»è¾‘ã€ä¸­é—´ä»¶ï¼ˆå¦‚å¤„ç†å¼‚æ­¥æ“ä½œï¼‰ã€æ›´å¥½çš„æ€§èƒ½ä¼˜åŒ–ï¼ˆç²¾ç¡®è®¢é˜…ï¼‰å’Œå¼ºå¤§çš„è°ƒè¯•å·¥å…·ï¼Œè¿™äº›åœ¨å¤§å‹åº”ç”¨ä¸­ç®¡ç†é¢‘ç¹æ›´æ–°çš„å…¨å±€çŠ¶æ€æ—¶éå¸¸æœ‰ä¼˜åŠ¿ã€‚Context API æ›´é€‚åˆå…±äº«ä¸ç»å¸¸å˜åŒ–æˆ–é€»è¾‘ç›¸å¯¹ç®€å•çš„å…¨å±€æ•°æ®ã€‚å±€éƒ¨çŠ¶æ€åº”ä¼˜å…ˆä½¿ç”¨ `useState`ã€‚çŠ¶æ€åº“å¹¶éè¦æ›¿ä»£æ‰€æœ‰ `useState`ã€‚</p>
                        </div>
                    </div>
                </section>

            </article>
        </main>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Initialize Mermaid after DOM is ready
        mermaid.initialize({ startOnLoad: true, theme: 'neutral' });

        document.addEventListener('DOMContentLoaded', () => {
            // --- TOC Highlighting & Fade-in Logic ---
            const sections = document.querySelectorAll('main section[id]');
            const tocLinks = document.querySelectorAll('#local-toc a');
            const mainContentSections = document.querySelectorAll('main > article > section.content-section');

            // TOC Highlighting
            const tocObserverOptions = { root: null, rootMargin: '-20% 0px -60% 0px', threshold: 0 };
            let lastActiveTocLink = null;

            const tocObserverCallback = (entries) => {
                let bestVisibleEntry = null;
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        if (!bestVisibleEntry || entry.boundingClientRect.top < bestVisibleEntry.boundingClientRect.top) {
                            bestVisibleEntry = entry;
                        }
                    }
                });
                if (bestVisibleEntry) {
                    const id = bestVisibleEntry.target.getAttribute('id');
                    const activeLink = document.querySelector(`#local-toc a[href="#${id}"]`);
                    if (activeLink && activeLink !== lastActiveTocLink) {
                        if (lastActiveTocLink) lastActiveTocLink.classList.remove('active');
                        activeLink.classList.add('active');
                        lastActiveTocLink = activeLink;
                    }
                }
            };
            const tocObserver = new IntersectionObserver(tocObserverCallback, tocObserverOptions);
            sections.forEach(section => tocObserver.observe(section));

            // Initial active link
            const currentHash = window.location.hash;
            if (currentHash) {
                const initialActiveLink = document.querySelector(`#local-toc a[href="${currentHash}"]`);
                if (initialActiveLink) {
                     tocLinks.forEach(link => link.classList.remove('active'));
                     initialActiveLink.classList.add('active');
                     lastActiveTocLink = initialActiveLink;
                }
            } else if (tocLinks.length > 0 && !lastActiveTocLink) {
                 tocLinks[0].classList.add('active');
                 lastActiveTocLink = tocLinks[0];
            }

            // Fade-in Animation
            const fadeObserverOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
            const fadeObserverCallback = (entries, observer) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        const delayIndex = Array.from(mainContentSections).indexOf(entry.target);
                        entry.target.style.animationDelay = `${delayIndex * 0.05}s`;
                        entry.target.classList.add('fade-in-section');
                        observer.unobserve(entry.target);
                    }
                });
            };
            const fadeObserver = new IntersectionObserver(fadeObserverCallback, fadeObserverOptions);
            mainContentSections.forEach(section => fadeObserver.observe(section));

            // --- Quiz Card Logic (Adapted from example.html) ---

            // Ripple Effect for Buttons
            function createRipple(event) {
                const button = event.currentTarget;
                // Check if button is a valid element and has getBoundingClientRect
                if (!button || typeof button.getBoundingClientRect !== 'function') return;

                const circle = document.createElement("span");
                const diameter = Math.max(button.clientWidth, button.clientHeight);
                const radius = diameter / 2;

                // Try to get RGB from CSS variable, fallback to default blue
                const primaryColorRgb = getComputedStyle(document.documentElement)
                                        .getPropertyValue('--primary-color-rgb')
                                        .trim() || '59, 130, 246'; // Default blue-500 RGB

                circle.style.width = circle.style.height = `${diameter}px`;
                const rect = button.getBoundingClientRect();
                circle.style.left = `${event.clientX - rect.left - radius}px`;
                circle.style.top = `${event.clientY - rect.top - radius}px`;
                circle.style.backgroundColor = `rgba(${primaryColorRgb}, 0.4)`; // Use RGB for opacity
                circle.classList.add("ripple");

                const existingRipple = button.querySelector(".ripple");
                if (existingRipple) existingRipple.remove();

                button.appendChild(circle);
                // Clean up ripple after animation
                setTimeout(() => circle.remove(), 600);
            }

            // Toggle Answer Visibility
            window.toggleAnswer = function(quizId, buttonElement) {
                const quizCard = document.getElementById(quizId);
                if (!quizCard) return;
                const answer = quizCard.querySelector('.quiz-answer');
                const icon = buttonElement?.querySelector('.icon-arrow'); // Make buttonElement optional check
                const buttonTextSpan = buttonElement?.querySelector('.button-text'); // Make buttonElement optional check

                if (!answer) return;

                const isVisible = answer.classList.contains('visible');

                if (isVisible) {
                    answer.style.maxHeight = '0';
                    answer.style.opacity = '0';
                    answer.style.marginTop = '0';
                    answer.style.paddingTop = '0';
                    answer.style.paddingBottom = '0';
                    answer.classList.remove('visible');
                    if (icon) icon.classList.remove('rotated');
                    if (buttonTextSpan) buttonTextSpan.textContent = ' æŸ¥çœ‹ç­”æ¡ˆ';
                    // Use setTimeout to set display: none after transition completes
                    setTimeout(() => {
                        // Double check if it's still hidden before setting display none
                        if (!answer.classList.contains('visible')) {
                            answer.style.display = 'none';
                        }
                    }, 500); // Match transition duration
                } else {
                    answer.style.display = 'block'; // Make it block to measure scrollHeight
                    // Set final styles before triggering transition
                    answer.style.paddingTop = '1rem';
                    answer.style.paddingBottom = '1rem';
                    answer.style.marginTop = '1rem';
                    // Use requestAnimationFrame to ensure display: block is applied before setting maxHeight
                    requestAnimationFrame(() => {
                        answer.style.maxHeight = answer.scrollHeight + 'px';
                        answer.style.opacity = '1';
                        answer.classList.add('visible');
                        if (icon) icon.classList.add('rotated');
                        if (buttonTextSpan) buttonTextSpan.textContent = ' éšè—ç­”æ¡ˆ';
                    });
                }
            }

            // Check Answer Logic
            window.checkAnswer = function(questionName, correctAnswerValue, quizId) {
                const options = document.querySelectorAll(`input[name="${questionName}"]`);
                const feedbackElement = document.getElementById(`feedback-${questionName}`);
                const quizCard = document.getElementById(quizId); // Use quizId passed to function
                let selectedValue = null;
                let selectedLabel = null;

                if (!feedbackElement || !quizCard) {
                    console.error("Quiz elements not found for:", questionName, quizId);
                    return;
                }

                // Reset previous feedback and styles
                quizCard.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected', 'correct', 'incorrect'));
                feedbackElement.style.display = 'none';
                feedbackElement.textContent = '';

                // Find selected option
                options.forEach(option => {
                    if (option.checked) {
                        selectedValue = option.value;
                        selectedLabel = option.closest('.quiz-option');
                        if (selectedLabel) selectedLabel.classList.add('selected');
                    }
                });

                // Check if an option was selected
                if (!selectedValue) {
                    feedbackElement.textContent = "è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼";
                    feedbackElement.className = 'quiz-feedback warning'; // Use warning class
                    feedbackElement.style.display = 'block';
                    return;
                }

                // Find the correct answer label
                let correctAnswerLabel = null;
                options.forEach(opt => {
                    if (opt.value === correctAnswerValue) {
                        correctAnswerLabel = opt.closest('.quiz-option');
                    }
                });

                // Provide feedback
                if (selectedValue === correctAnswerValue) {
                    feedbackElement.textContent = "å›ç­”æ­£ç¡®ï¼";
                    feedbackElement.className = 'quiz-feedback correct';
                    if(selectedLabel) selectedLabel.classList.add('correct');
                } else {
                    let correctAnswerText = '';
                    if (correctAnswerLabel) {
                        // Try to get text from the span inside the label
                        correctAnswerText = correctAnswerLabel.querySelector('span')?.textContent || `é€‰é¡¹ ${correctAnswerValue}`;
                        correctAnswerLabel.classList.add('correct'); // Highlight the correct one
                    }
                    feedbackElement.textContent = `å›ç­”é”™è¯¯ã€‚æ­£ç¡®ç­”æ¡ˆæ˜¯: "${correctAnswerText}"`;
                    feedbackElement.className = 'quiz-feedback incorrect';
                    if(selectedLabel) selectedLabel.classList.add('incorrect'); // Mark the wrong selection
                }
                feedbackElement.style.display = 'block';

                // Automatically show the answer section when checking
                const toggleButton = quizCard.querySelector('.quiz-toggle');
                const answerSection = quizCard.querySelector('.quiz-answer');
                if (toggleButton && answerSection && !answerSection.classList.contains('visible')) {
                    toggleAnswer(quizId, toggleButton);
                }
            }

            // Add ripple effect to all quiz toggle buttons
            document.querySelectorAll('.quiz-toggle').forEach(button => {
                button.addEventListener('click', createRipple);
            });

        }); // End DOMContentLoaded
    </script>

</body>

</html>
