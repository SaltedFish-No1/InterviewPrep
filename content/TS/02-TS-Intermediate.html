<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeScript è¿›é˜¶æ¦‚å¿µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../../global.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <style>
        /* Primarily rely on global.css and Tailwind */

        /* --- Base & Layout Adjustments --- */
        html {
            scroll-padding-top: 6rem; /* Adjust if header is sticky */
            scroll-behavior: smooth;
        }

        body {
            /* Base font, bg, color assumed from global.css */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-family: 'Inter', sans-serif; /* Ensure Inter is the base font */
        }

        /* --- Typography & Sectioning --- */
        h1, h2, h3, h4, h5, h6 {
            scroll-margin-top: 6rem; /* Offset for sticky nav */
        }

        /* Apply border bottom to H2 in content sections */
        .content-section > h2 {
            border-bottom: 1px solid var(--border-color-light);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem; /* Consistent spacing after H2 */
        }

        /* Style for frequency/level tags */
        .level-tag {
            display: inline-block;
            margin-left: 0.5rem;
            font-size: 0.75rem; /* text-xs */
            font-weight: 500; /* font-medium */
            padding: 0.1rem 0.5rem;
            border-radius: 0.25rem; /* rounded-sm */
            vertical-align: middle;
            border: 1px solid transparent;
        }
        .level-tag-high { background-color: var(--danger-color-light); color: var(--danger-color); border-color: var(--danger-color); }
        .level-tag-medium { background-color: var(--warning-color-light); color: var(--warning-color); border-color: var(--warning-color); }
        .level-tag-low { background-color: var(--secondary-color-light); color: var(--secondary-color); border-color: var(--secondary-color); }
        .level-tag-base { background-color: var(--bg-color-lighter); color: var(--text-color-light); border-color: var(--border-color-default); }
        .level-tag-advanced { background-color: var(--primary-color-light); color: var(--primary-color-dark); border-color: var(--primary-color); }

        /* --- Fade-in Animation --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in-section {
            opacity: 0;
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* --- Code Block Styling --- */
        pre[class*="language-"] {
            margin-top: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.375rem; /* rounded-md */
            padding: 1rem; /* p-4 */
            font-family: 'Roboto Mono', monospace; /* Ensure mono font */
            overflow-x: auto;
        }
        *:not(pre) > code {
            font-family: 'Roboto Mono', monospace;
            font-size: 0.9em;
            background-color: rgba(243, 244, 246, 0.8); /* bg-gray-100 with opacity */
            color: var(--primary-color-dark);
            padding: 0.1em 0.4em;
            border-radius: 0.25rem;
            border: 1px solid var(--border-color-light);
        }

        /* --- Content Card Adjustments --- */
        /* Add hover effect */
        .content-card {
            transition: box-shadow 0.2s ease-in-out;
        }
        /* Use shadow-md on hover for subtle feedback */
        .content-card:hover {
             box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* Tailwind shadow-md */
        }
        .content-section > .content-card + .content-card {
            margin-top: 1.5rem;
        }
        .content-card > *:last-child:not(.quiz-card) { /* Avoid removing margin from quiz card itself */
            margin-bottom: 0 !important;
        }

        /* --- Tooltips (Adapted from example.html) --- */
        .tooltip-term {
            border-bottom: 1px dotted var(--primary-color);
            cursor: help;
            position: relative;
            color: var(--primary-color);
            font-weight: 500;
        }
        .tooltip-term::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            background-color: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 0.4rem 0.75rem;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
            z-index: 10;
        }
        .tooltip-term::after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(0px);
            border-width: 5px;
            border-style: solid;
            border-color: rgba(0, 0, 0, 0.85) transparent transparent transparent;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
            z-index: 10;
        }
        .tooltip-term:hover::before,
        .tooltip-term:hover::after {
            opacity: 1;
            visibility: visible;
        }

        /* --- Mermaid Diagram Styling --- */
        .mermaid {
            margin: 1.5rem 0;
            text-align: center;
            background-color: var(--bg-color-light);
            padding: 1rem;
            border-radius: 0.375rem;
            border: 1px solid var(--border-color-light);
        }
        .mermaid svg { max-width: 100%; height: auto; display: block; margin: auto; }

        /* --- Quiz Card Styling (Adapted from example.html & global.css) --- */
        /* .quiz-card styles are mostly in global.css */
        /* Ensure necessary styles for toggle button and answer visibility are present */
        .quiz-toggle {
            position: relative;
            overflow: hidden;
            /* Ensure ripple stays inside */
            /* Use button classes from global.css */
        }
        .quiz-toggle .material-icons {
            font-size: 1.1rem;
            transition: transform 0.3s ease-in-out;
        }
        .quiz-toggle .icon-arrow.rotated {
            transform: rotate(180deg);
        }
        .quiz-answer {
            max-height: 0;
            opacity: 0;
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out, padding-top 0.5s ease-in-out, padding-bottom 0.5s ease-in-out, margin-top 0.5s ease-in-out;
            overflow: hidden;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
            border-top: 1px solid var(--border-color-default); /* Add separator */
            background-color: var(--bg-color-lighter);
            border-radius: 0 0 0.375rem 0.375rem; /* Round bottom corners */
            color: var(--text-color-default);
        }
        .quiz-answer.visible {
            max-height: 1000px; /* Adjust if needed */
            opacity: 1;
            padding-top: 1rem;
            padding-bottom: 1rem;
            margin-top: 1rem;
            overflow: auto;
        }
        /* Ripple effect (copied from example.html) */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(var(--primary-color-rgb, 59, 130, 246), 0.4); /* Use RGB for opacity */
            transform: scale(0);
            animation: ripple-animation 0.6s linear;
            pointer-events: none;
        }
        @keyframes ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

    </style>
</head>

<body class="bg-gray-100"> <div class="page-container"> <aside class="local-side-nav">
            <h4 class="head4">TypeScript è¿›é˜¶</h4> <ul id="local-toc">
                <li><a href="#generics" class="active"><span class="material-icons nav-icon">code</span>æ³›å‹</a></li>
                <li><a href="#union-intersection"><span class="material-icons nav-icon">merge_type</span>è”åˆä¸äº¤å‰ç±»å‹</a></li>
                <li><a href="#utility-types"><span class="material-icons nav-icon">build</span>å¸¸ç”¨å·¥å…·ç±»å‹</a></li>
                <li class="ml-4"><a href="#utility-partial" class="text-sm"><span class="material-icons nav-icon text-base">texture</span>Partial&lt;T&gt;</a></li>
                 <li class="ml-4"><a href="#utility-required" class="text-sm"><span class="material-icons nav-icon text-base">check_box</span>Required&lt;T&gt;</a></li>
                 <li class="ml-4"><a href="#utility-pick" class="text-sm"><span class="material-icons nav-icon text-base">content_cut</span>Pick&lt;T, K&gt;</a></li>
                 <li class="ml-4"><a href="#utility-omit" class="text-sm"><span class="material-icons nav-icon text-base">disabled_by_default</span>Omit&lt;T, K&gt;</a></li>
            </ul>
            <a href="../../index.html" class="back-link">
                &larr; è¿”å›å¤§çº²ç›®å½•
            </a>
        </aside>

        <main class="content-main">
            <article>
                <section id="intro" class="content-section fade-in-section" style="animation-delay: 0s;">
                    <h1 class="head1 flex items-center gap-2">
                        <span class="material-icons text-3xl text-blue-600">integration_instructions</span>TypeScript è¿›é˜¶æ¦‚å¿µ
                    </h1>
                    <p class="mb-4">æœ¬èŠ‚ä»‹ç» TypeScript ä¸­ä¸€äº›é‡è¦çš„è¿›é˜¶æ¦‚å¿µï¼ŒåŒ…æ‹¬æ³›å‹ã€è”åˆç±»å‹ã€äº¤å‰ç±»å‹ä»¥åŠå¸¸ç”¨çš„å·¥å…·ç±»å‹ã€‚ç†è§£è¿™äº›æ¦‚å¿µæœ‰åŠ©äºç¼–å†™æ›´çµæ´»ã€å¯é‡ç”¨ä¸”ç±»å‹å®‰å…¨çš„ä»£ç ã€‚</p>
                    <p class="mt-4 bg-blue-50 border-l-4 border-blue-500 text-blue-700 p-4 rounded-md text-sm">ğŸ’¡
                        <strong>æç¤º:</strong> ç‚¹å‡»å·¦ä¾§å¯¼èˆªå¯ä»¥å¿«é€Ÿè·³è½¬åˆ°ç›¸åº”ä¸»é¢˜ã€‚ä»£ç ç¤ºä¾‹ä½¿ç”¨äº† TypeScript è¯­æ³•ã€‚å°è¯•å›ç­”æ¯èŠ‚æœ«å°¾çš„æµ‹éªŒé¢˜ï¼å°†é¼ æ ‡æ‚¬åœåœ¨ <span class="tooltip-term" data-tooltip="åƒè¿™æ ·!">å¸¦ä¸‹åˆ’çº¿çš„æœ¯è¯­</span> ä¸Šå¯æŸ¥çœ‹è§£é‡Šã€‚
                    </p>
                </section>

                <section id="generics" class="content-section fade-in-section" style="animation-delay: 0.05s;">
                    <h2 class="head2 flex items-center">
                        <span class="material-icons">code</span>æ³›å‹ (Generics)
                        <span class="level-tag level-tag-low">ä½é¢‘</span>
                        <span class="level-tag level-tag-base">åŸºç¡€</span>
                        <span class="level-tag level-tag-advanced">è¿›é˜¶(äº†è§£)</span>
                    </h2>
                    <div class="content-card hover:shadow-md">
                        <h3 class="head3">åŸºæœ¬æ¦‚å¿µ</h3>
                        <p>æ³›å‹å…è®¸æˆ‘ä»¬ç¼–å†™å¯é‡ç”¨çš„ä»£ç ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥åœ¨<b>ä½¿ç”¨æ—¶</b>æ‰æŒ‡å®šå…·ä½“çš„ç±»å‹ï¼Œè€Œä¸æ˜¯åœ¨å®šä¹‰æ—¶å†™æ­»ã€‚è¿™å°±åƒç»™ç±»å‹è®¾ç½®äº†ä¸€ä¸ª<span class="tooltip-term" data-tooltip="å¦‚ <T> ä¸­çš„ Tï¼Œå®ƒæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œåœ¨ä½¿ç”¨æ—¶ä¼šè¢«å…·ä½“ç±»å‹æ›¿æ¢">ç±»å‹å˜é‡ (Type Variable)</span>æˆ–å ä½ç¬¦ã€‚</p>
                        <p class="mt-2">ä¸»è¦ç›®çš„æ˜¯æé«˜ä»£ç çš„<b>çµæ´»æ€§</b>å’Œ<b>å¤ç”¨æ€§</b>ï¼ŒåŒæ—¶ä¿æŒ<b>ç±»å‹å®‰å…¨</b>ã€‚</p>
                    </div>
                    <div class="content-card hover:shadow-md">
                        <h3 class="head3">ç®€å•åº”ç”¨</h3>
                        <p>ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ˜¯ <code>identity</code> å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°å¹¶è¿”å›è¯¥å‚æ•°æœ¬èº«ã€‚</p>
                        <pre><code class="language-typescript">
// å®šä¹‰ä¸€ä¸ªæ³›å‹å‡½æ•° identity
// T æ˜¯ç±»å‹å˜é‡ï¼Œä»£è¡¨ä»»ä½•ç±»å‹
function identity&lt;T&gt;(arg: T): T {
  return arg;
}

// ä½¿ç”¨æ—¶æ˜¾å¼æŒ‡å®šç±»å‹
let outputString = identity&lt;string&gt;("hello generics"); // T is string
let outputNumber = identity&lt;number&gt;(123);          // T is number

// ç±»å‹æ¨æ–­ï¼šTS ä¹Ÿèƒ½è‡ªåŠ¨æ¨æ–­ T çš„ç±»å‹
let inferredString = identity("hello again");     // TS infers T as string
let inferredBoolean = identity(true);         // TS infers T as boolean

console.log(outputString); // "hello generics"
console.log(outputNumber); // 123
console.log(inferredString); // "hello again"
console.log(inferredBoolean); // true
                        </code></pre>
                        <p class="mt-4">æ³›å‹ä¹Ÿå¸¸ç”¨äºå®šä¹‰æ•°æ®ç»“æ„ï¼Œå¦‚æ¥å£æˆ–ç±»ï¼š</p>
                        <pre><code class="language-typescript">
// å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£ Box
interface Box&lt;T&gt; {
  contents: T;
}

let numberBox: Box&lt;number&gt; = { contents: 42 };
let stringBox: Box&lt;string&gt; = { contents: "TypeScript" };

console.log(numberBox.contents); // 42
console.log(stringBox.contents); // "TypeScript"
                        </code></pre>
                    </div>
                     <div class="quiz-card mt-6" id="quiz-generics">
                        <div class="quiz-question"><span class="material-icons mr-1">quiz</span>æ³›å‹æµ‹éªŒï¼šæ³›å‹çš„ä¸»è¦ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</div>
                        <div class="quiz-options">
                            <label class="quiz-option"><input type="radio" name="q_generics" value="a"><span>ä»…ç”¨äºå‡½æ•°å®šä¹‰</span></label>
                            <label class="quiz-option"><input type="radio" name="q_generics" value="b"><span>æé«˜ä»£ç å¤ç”¨æ€§å’Œç±»å‹å®‰å…¨</span></label>
                            <label class="quiz-option"><input type="radio" name="q_generics" value="c"><span>æ›¿ä»£æ‰€æœ‰ interface å®šä¹‰</span></label>
                            <label class="quiz-option"><input type="radio" name="q_generics" value="d"><span>ç®€åŒ– JavaScript ä»£ç </span></label>
                        </div>
                        <div class="quiz-feedback mt-4" id="feedback-q_generics"></div>
                        <button class="quiz-toggle button button-secondary mt-4" onclick="checkAnswer('q_generics', 'b')">
                             <span class="material-icons icon-arrow">expand_more</span><span class="button-text">æ£€æŸ¥ç­”æ¡ˆ</span>
                        </button>
                        <div class="quiz-answer" style="display: none;">
                           <p><strong>ç­”æ¡ˆ:</strong> B. æé«˜ä»£ç å¤ç”¨æ€§å’Œç±»å‹å®‰å…¨</p>
                           <p><strong>è§£æ:</strong> æ³›å‹å…è®¸æˆ‘ä»¬ç¼–å†™ä¸ç±»å‹æ— å…³çš„å¯é‡ç”¨ä»£ç ï¼ˆå¦‚ <code>identity</code> å‡½æ•°æˆ– <code>Box</code> æ¥å£ï¼‰ï¼ŒåŒæ—¶åœ¨ç¼–è¯‘æ—¶å¼ºåˆ¶æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚</p>
                       </div>
                    </div>
                </section>

                <section id="union-intersection" class="content-section fade-in-section" style="animation-delay: 0.1s;">
                     <h2 class="head2 flex items-center">
                        <span class="material-icons">merge_type</span>è”åˆç±»å‹ (<code>|</code>) ä¸äº¤å‰ç±»å‹ (<code>&</code>)
                        <span class="level-tag level-tag-low">ä½é¢‘</span>
                        <span class="level-tag level-tag-base">åŸºç¡€</span>
                    </h2>
                    <div class="content-card hover:shadow-md">
                        <h3 class="head3">è”åˆç±»å‹ (Union Types |)</h3>
                        <p>è”åˆç±»å‹è¡¨ç¤ºä¸€ä¸ªå€¼å¯ä»¥æ˜¯<b>å¤šç§ç±»å‹ä¸­çš„ä¸€ç§</b>ã€‚ä½¿ç”¨ <code>|</code> åˆ†éš”ã€‚</p>
                        <div class="mermaid">
                            graph TD
                                subgraph "è”åˆç±»å‹: string | number"
                                    A[Value] --> B((string));
                                    A --> C((number));
                                end
                                style A fill:#fff,stroke:#333,stroke-width:2px
                                style B fill:#eff6ff,stroke:#3b82f6
                                style C fill:#fef3c7,stroke:#ca8a04
                        </div>
                        <pre><code class="language-typescript">
// å‡½æ•°å‚æ•°å¯ä»¥æ˜¯ string æˆ– number
function printId(id: string | number) {
  console.log("ID: " + id);

  // æ³¨æ„ï¼šç›´æ¥è®¿é—®è”åˆç±»å‹å˜é‡æ—¶ï¼Œåªèƒ½è®¿é—®æ‰€æœ‰ç±»å‹å…±æœ‰çš„æˆå‘˜
  // console.log(id.toUpperCase()); // Error: Property 'toUpperCase' does not exist on type 'string | number'.

  // éœ€è¦ä½¿ç”¨ <span class="tooltip-term" data-tooltip="é€šè¿‡ typeof, instanceof, å±æ€§æ£€æŸ¥ç­‰æ–¹å¼ï¼Œåœ¨ç‰¹å®šä»£ç å—ä¸­ç¼©å°å˜é‡çš„ç±»å‹èŒƒå›´">ç±»å‹æ”¶çª„ (Type Narrowing)</span> æ¥åŒºåˆ†
  if (typeof id === "string") {
    // TS çŸ¥é“è¿™é‡Œ id æ˜¯ string
    console.log(id.toUpperCase());
  } else {
    // TS çŸ¥é“è¿™é‡Œ id æ˜¯ number
    console.log(id.toFixed(2));
  }
}

printId("abc-123"); // ID: abc-123, ABC-123
printId(456.7);    // ID: 456.7, 456.70
// printId(true); // Error: Argument of type 'boolean' is not assignable to parameter of type 'string | number'.
                        </code></pre>
                    </div>
                    <div class="content-card hover:shadow-md">
                        <h3 class="head3">äº¤å‰ç±»å‹ (Intersection Types &)</h3>
                        <p>äº¤å‰ç±»å‹æ˜¯å°†<b>å¤šä¸ªç±»å‹åˆå¹¶ä¸ºä¸€ä¸ªç±»å‹</b>ï¼Œåˆå¹¶åçš„ç±»å‹æ‹¥æœ‰<b>æ‰€æœ‰</b>ç»„æˆç±»å‹çš„æˆå‘˜ã€‚ä½¿ç”¨ <code>&</code> è¿æ¥ã€‚</p>
                         <div class="mermaid">
                            graph TD
                                subgraph "æ¥å£ A"
                                    PropA["propA: string"]
                                end
                                subgraph "æ¥å£ B"
                                    PropB["propB: number"]
                                end
                                subgraph "äº¤å‰ç±»å‹: A & B"
                                    Merged["æ‹¥æœ‰ propA å’Œ propB"]
                                end
                                PropA --> Merged;
                                PropB --> Merged;

                                style PropA fill:#dbeafe,stroke:#60a5fa
                                style PropB fill:#dcfce7,stroke:#34d399
                                style Merged fill:#f1f5f9,stroke:#64748b,stroke-width:2px
                        </div>
                        <pre><code class="language-typescript">
interface Colorful {
  color: string;
}

interface Circle {
  radius: number;
}

// äº¤å‰ç±»å‹ï¼šColorfulCircle å¿…é¡»åŒæ—¶æ‹¥æœ‰ color å’Œ radius
type ColorfulCircle = Colorful & Circle;

function drawShape(shape: ColorfulCircle) {
  console.log(`Drawing a ${shape.color} circle with radius ${shape.radius}`);
}

const myShape: ColorfulCircle = {
  color: "blue",
  radius: 10
};

drawShape(myShape); // Drawing a blue circle with radius 10

// drawShape({ color: "red" }); // Error: Property 'radius' is missing
// drawShape({ radius: 5 });    // Error: Property 'color' is missing
                        </code></pre>
                    </div>
                     <div class="quiz-card mt-6" id="quiz-union-intersection">
                        <div class="quiz-question"><span class="material-icons mr-1">quiz</span>ç±»å‹æµ‹éªŒï¼šå¦‚æœä¸€ä¸ªç±»å‹å®šä¹‰ä¸º <code>Dog & Cat</code>ï¼Œå®ƒè¡¨ç¤ºä»€ä¹ˆï¼Ÿ</div>
                        <div class="quiz-options">
                            <label class="quiz-option"><input type="radio" name="q_union_intersection" value="a"><span>è¿™ä¸ªå€¼è¦ä¹ˆæ˜¯ Dog ç±»å‹ï¼Œè¦ä¹ˆæ˜¯ Cat ç±»å‹</span></label>
                            <label class="quiz-option"><input type="radio" name="q_union_intersection" value="b"><span>è¿™ä¸ªå€¼å¿…é¡»åŒæ—¶æ‹¥æœ‰ Dog å’Œ Cat ç±»å‹çš„æ‰€æœ‰å±æ€§</span></label>
                            <label class="quiz-option"><input type="radio" name="q_union_intersection" value="c"><span>è¿™ä¸ªå€¼å¯ä»¥æ˜¯ Dog æˆ– Catï¼Œæˆ–è€…æ˜¯ä¸¤è€…çš„æ··åˆ</span></label>
                            <label class="quiz-option"><input type="radio" name="q_union_intersection" value="d"><span>è¿™æ˜¯ä¸€ä¸ªæ— æ•ˆçš„ç±»å‹å®šä¹‰</span></label>
                        </div>
                        <div class="quiz-feedback mt-4" id="feedback-q_union_intersection"></div>
                        <button class="quiz-toggle button button-secondary mt-4" onclick="checkAnswer('q_union_intersection', 'b')">
                             <span class="material-icons icon-arrow">expand_more</span><span class="button-text">æ£€æŸ¥ç­”æ¡ˆ</span>
                        </button>
                        <div class="quiz-answer" style="display: none;">
                           <p><strong>ç­”æ¡ˆ:</strong> B. è¿™ä¸ªå€¼å¿…é¡»åŒæ—¶æ‹¥æœ‰ Dog å’Œ Cat ç±»å‹çš„æ‰€æœ‰å±æ€§</p>
                           <p><strong>è§£æ:</strong> äº¤å‰ç±»å‹ (<code>&</code>) ç”¨äºåˆå¹¶å¤šä¸ªç±»å‹ï¼Œç»“æœç±»å‹éœ€è¦æ»¡è¶³æ‰€æœ‰åŸå§‹ç±»å‹çš„è¦æ±‚ï¼Œå³æ‹¥æœ‰æ‰€æœ‰ç±»å‹çš„æˆå‘˜ã€‚</p>
                       </div>
                    </div>
                </section>

                <section id="utility-types" class="content-section fade-in-section" style="animation-delay: 0.15s;">
                    <h2 class="head2 flex items-center">
                        <span class="material-icons">build</span>å¸¸ç”¨å·¥å…·ç±»å‹ (Utility Types)
                        <span class="level-tag level-tag-low">ä½é¢‘</span>
                        <span class="level-tag level-tag-base">åŸºç¡€</span>
                    </h2>
                    <p class="mb-4">TypeScript æä¾›äº†ä¸€äº›å†…ç½®çš„å·¥å…·ç±»å‹ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åŸºäºç°æœ‰ç±»å‹åˆ›å»ºæ–°ç±»å‹ã€‚</p>

                    <div id="utility-partial" class="content-card hover:shadow-md">
                        <h3 class="head3"><code>Partial&lt;T&gt;</code></h3>
                        <p>å°†ç±»å‹ <code>T</code> ä¸­çš„<b>æ‰€æœ‰å±æ€§</b>å˜ä¸º<b>å¯é€‰çš„</b> (optional)ã€‚</p>
                        <p class="text-sm text-gray-600 mt-1">å¸¸ç”¨äºæ›´æ–°æ“ä½œï¼Œåªä¼ é€’éœ€è¦ä¿®æ”¹çš„å­—æ®µã€‚</p>
                        <pre><code class="language-typescript">
interface Todo {
  title: string;
  description: string;
  completed: boolean;
}

// æ›´æ–°å‡½æ•°æ¥å—ä¸€ä¸ªå¯é€‰çš„å­—æ®µé›†åˆ
function updateTodo(todo: Todo, fieldsToUpdate: Partial&lt;Todo&gt;) {
  return { ...todo, ...fieldsToUpdate };
}

const todo1: Todo = { title: "Learn TS", description: "Generics", completed: false };
const updatedTodo = updateTodo(todo1, { description: "Utility Types" }); // åªæ›´æ–° description

console.log(updatedTodo);
// Output: { title: 'Learn TS', description: 'Utility Types', completed: false }
                        </code></pre>
                    </div>

                    <div id="utility-required" class="content-card hover:shadow-md">
                        <h3 class="head3"><code>Required&lt;T&gt;</code></h3>
                        <p>å°†ç±»å‹ <code>T</code> ä¸­çš„<b>æ‰€æœ‰å±æ€§</b>ï¼ˆåŒ…æ‹¬åŸæœ¬å¯é€‰çš„ï¼‰å˜ä¸º<b>å¿…éœ€çš„</b> (required)ã€‚</p>
                        <pre><code class="language-typescript">
interface Props {
  a?: number; // a is optional
  b: string;
}

// åŸå§‹ç±»å‹å…è®¸ a ç¼ºå¤±
const props1: Props = { b: "hello" };

// Required ç±»å‹è¦æ±‚æ‰€æœ‰å±æ€§éƒ½å­˜åœ¨
const completeProps: Required&lt;Props&gt; = { a: 1, b: "world" }; // OK

// const incompleteProps: Required&lt;Props&gt; = { b: "test" };
// Error: Property 'a' is missing in type '{ b: string; }' but required in type 'Required&lt;Props&gt;'.
                        </code></pre>
                    </div>

                    <div id="utility-pick" class="content-card hover:shadow-md">
                        <h3 class="head3"><code>Pick&lt;T, K&gt;</code></h3>
                        <p>ä»ç±»å‹ <code>T</code> ä¸­<b>æŒ‘é€‰å‡º</b>æŒ‡å®šçš„å±æ€§ <code>K</code> æ¥æ„é€ ä¸€ä¸ªæ–°ç±»å‹ã€‚</p>
                         <pre><code class="language-typescript">
interface User {
  id: number;
  name: string;
  email: string;
  isAdmin: boolean;
}

// åªæŒ‘é€‰ 'name' å’Œ 'email' å±æ€§
type UserPreview = Pick&lt;User, "name" | "email"&gt;;

const userPreview: UserPreview = {
  name: "Alice",
  email: "alice@example.com"
  // id: 1 // Error: Type '{ name: string; email: string; id: number; }' is not assignable to type 'UserPreview'.
           // Object literal may only specify known properties, and 'id' does not exist in type 'UserPreview'.
};

console.log(userPreview); // { name: 'Alice', email: 'alice@example.com' }
                        </code></pre>
                    </div>

                     <div id="utility-omit" class="content-card hover:shadow-md">
                        <h3 class="head3"><code>Omit&lt;T, K&gt;</code></h3>
                        <p>ä»ç±»å‹ <code>T</code> ä¸­<b>ç§»é™¤</b>æŒ‡å®šçš„å±æ€§ <code>K</code>ï¼Œç”¨å‰©ä¸‹çš„å±æ€§æ„é€ ä¸€ä¸ªæ–°ç±»å‹ã€‚</p>
                        <pre><code class="language-typescript">
interface UserWithPassword {
  id: number;
  username: string;
  passwordHash: string; // Sensitive info
}

// ç§»é™¤ 'passwordHash' å±æ€§
type PublicUser = Omit&lt;UserWithPassword, "passwordHash"&gt;;

const publicUserData: PublicUser = {
  id: 1,
  username: "bob"
  // passwordHash: "..." // Error: Type '{ id: number; username: string; passwordHash: string; }' is not assignable to type 'PublicUser'.
                         // Object literal may only specify known properties, and 'passwordHash' does not exist in type 'PublicUser'.
};

console.log(publicUserData); // { id: 1, username: 'bob' }
                        </code></pre>
                    </div>
                     <div class="quiz-card mt-6" id="quiz-utility">
                        <div class="quiz-question"><span class="material-icons mr-1">quiz</span>å·¥å…·ç±»å‹æµ‹éªŒï¼šå¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªç±»å‹ï¼Œå®ƒåŒ…å« <code>User</code> ç±»å‹çš„æ‰€æœ‰å±æ€§ï¼Œä½† <code>email</code> å±æ€§å˜ä¸ºå¯é€‰çš„ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ</div>
                        <div class="quiz-options">
                            <label class="quiz-option"><input type="radio" name="q_utility" value="a"><span><code>Partial&lt;User&gt;</code></span></label>
                            <label class="quiz-option"><input type="radio" name="q_utility" value="b"><span><code>Omit&lt;User, "email"&gt; & { email?: string }</code></span></label>
                            <label class="quiz-option"><input type="radio" name="q_utility" value="c"><span><code>Pick&lt;User, "id" | "name" | "isAdmin"&gt; & Partial&lt;Pick&lt;User, "email"&gt;&gt;</code></span></label>
                            <label class="quiz-option"><input type="radio" name="q_utility" value="d"><span><code>Required&lt;Omit&lt;User, "email"&gt;&gt; & { email?: string }</code></span></label>
                        </div>
                        <div class="quiz-feedback mt-4" id="feedback-q_utility"></div>
                        <button class="quiz-toggle button button-secondary mt-4" onclick="checkAnswer('q_utility', 'c')">
                             <span class="material-icons icon-arrow">expand_more</span><span class="button-text">æ£€æŸ¥ç­”æ¡ˆ</span>
                        </button>
                        <div class="quiz-answer" style="display: none;">
                           <p><strong>ç­”æ¡ˆ:</strong> C. <code>Pick&lt;User, "id" | "name" | "isAdmin"&gt; & Partial&lt;Pick&lt;User, "email"&gt;&gt;</code> (æˆ– B ä¹Ÿæ˜¯ä¸€ç§å¸¸è§æ–¹å¼)</p>
                           <p><strong>è§£æ:</strong></p>
                            <ul>
                                <li>A: <code>Partial&lt;User&gt;</code> ä¼šä½¿æ‰€æœ‰å±æ€§éƒ½å¯é€‰ã€‚</li>
                                <li>B: <code>Omit&lt;User, "email"&gt; & { email?: string }</code> å…ˆç§»é™¤ emailï¼Œå†æ·»åŠ ä¸€ä¸ªå¯é€‰çš„ emailï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¸¸ç”¨çš„å®ç°æ–¹å¼ã€‚</li>
                                <li>C: <code>Pick</code> å‡ºå¿…éœ€çš„å±æ€§ï¼Œå† <code>Pick</code> å‡º email å¹¶ç”¨ <code>Partial</code> ä½¿å…¶å¯é€‰ï¼Œæœ€åç”¨ <code>&</code> åˆå¹¶ã€‚è¿™æ˜¯å¦ä¸€ç§ç²¾ç¡®æ§åˆ¶çš„æ–¹å¼ã€‚</li>
                                <li>D: <code>Required</code> ä¼šä½¿ Omit åçš„å±æ€§å˜ä¸ºå¿…éœ€ï¼Œä¸ç¬¦åˆè¦æ±‚ã€‚</li>
                            </ul>
                           <p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€‰é¡¹ B å’Œ C éƒ½èƒ½è¾¾åˆ°ç›®çš„ï¼ŒC æ›´èƒ½ä½“ç° Pick å’Œ Partial çš„ç»„åˆè¿ç”¨ã€‚</p>
                       </div>
                    </div>
                </section>

            </article>
        </main>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <script>
        // Initialize Mermaid
        mermaid.initialize({ startOnLoad: true, theme: 'neutral' }); // Use neutral theme

        // --- Ripple Effect Logic (from example.html) ---
        function createRipple(event) {
            const button = event.currentTarget;
            if (!button || typeof button.getBoundingClientRect !== 'function') return;
            const circle = document.createElement("span");
            const diameter = Math.max(button.clientWidth, button.clientHeight);
            const radius = diameter / 2;
            // Attempt to get RGB from CSS variable, fallback to default blue
            const primaryColorRgb = getComputedStyle(document.documentElement).getPropertyValue('--primary-color-rgb').trim() || '59, 130, 246';
            circle.style.width = circle.style.height = `${diameter}px`;
            const rect = button.getBoundingClientRect();
            circle.style.left = `${event.clientX - rect.left - radius}px`;
            circle.style.top = `${event.clientY - rect.top - radius}px`;
            circle.style.backgroundColor = `rgba(${primaryColorRgb}, 0.4)`;
            circle.classList.add("ripple");
            const existingRipple = button.querySelector(".ripple");
            if (existingRipple) existingRipple.remove();
            button.appendChild(circle);
            setTimeout(() => circle.remove(), 600); // Remove ripple after animation
        }

         // --- Quiz Toggle Logic (from example.html) ---
        function toggleAnswer(quizId, buttonElement) {
            const quizCard = document.getElementById(quizId);
            if (!quizCard) return;
            const answer = quizCard.querySelector('.quiz-answer');
            const icon = buttonElement.querySelector('.icon-arrow');
            const buttonTextSpan = buttonElement.querySelector('.button-text');
            if (!answer || !icon || !buttonTextSpan) return;

            const isVisible = answer.classList.contains('visible');

            if (isVisible) {
                // Hide the answer
                answer.style.maxHeight = '0';
                answer.style.opacity = '0';
                answer.style.marginTop = '0';
                answer.style.paddingTop = '0';
                answer.style.paddingBottom = '0';
                answer.classList.remove('visible');
                icon.classList.remove('rotated');
                buttonTextSpan.textContent = ' æ£€æŸ¥ç­”æ¡ˆ'; // Or 'æŸ¥çœ‹ç­”æ¡ˆ' if separate button
                 // Use timeout to potentially reset display property after transition
                setTimeout(() => {
                    if (!answer.classList.contains('visible')) {
                         // Reset styles that might prevent future showing if needed
                         answer.style.removeProperty('max-height');
                         answer.style.removeProperty('opacity');
                         answer.style.removeProperty('margin-top');
                         answer.style.removeProperty('padding-top');
                         answer.style.removeProperty('padding-bottom');
                         answer.style.display = 'none'; // Ensure it's hidden
                    }
                }, 500); // Match transition duration
            } else {
                // Show the answer
                answer.style.display = 'block'; // Make it visible to calculate scrollHeight
                // Set styles for the open state *before* calculating scrollHeight
                answer.style.paddingTop = '1rem';
                answer.style.paddingBottom = '1rem';
                answer.style.marginTop = '1rem';

                // Use requestAnimationFrame to ensure display:block is applied before measuring scrollHeight
                requestAnimationFrame(() => {
                    answer.style.maxHeight = answer.scrollHeight + 'px';
                    answer.style.opacity = '1';
                    answer.classList.add('visible');
                    icon.classList.add('rotated');
                    buttonTextSpan.textContent = ' éšè—ç­”æ¡ˆ';
                });
            }
        }

        // --- Quiz Check Answer Logic (from example.html) ---
        function checkAnswer(questionName, correctAnswerValue) {
            const options = document.querySelectorAll(`input[name="${questionName}"]`);
            const feedbackElement = document.getElementById(`feedback-${questionName}`);
            const quizCard = feedbackElement ? feedbackElement.closest('.quiz-card') : null;
            let selectedValue = null;
            let selectedLabel = null;

            if (!feedbackElement || !quizCard) {
                console.error("Quiz elements not found for:", questionName);
                return;
            }

            // Reset previous feedback styles
            quizCard.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected', 'correct', 'incorrect'));
            feedbackElement.textContent = ""; // Clear previous feedback text
            feedbackElement.style.display = 'none'; // Hide feedback initially

            options.forEach(option => {
                if (option.checked) {
                    selectedValue = option.value;
                    selectedLabel = option.closest('.quiz-option');
                    if (selectedLabel) selectedLabel.classList.add('selected');
                }
            });

            if (!selectedValue) {
                feedbackElement.textContent = "è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼";
                feedbackElement.className = 'quiz-feedback warning'; // Use warning class from global.css if available
                feedbackElement.style.display = 'block';
                return;
            }

            let correctAnswerLabel = null;
            options.forEach(opt => { if (opt.value === correctAnswerValue) correctAnswerLabel = opt.closest('.quiz-option'); });

            if (selectedValue === correctAnswerValue) {
                feedbackElement.textContent = "å›ç­”æ­£ç¡®ï¼";
                feedbackElement.className = 'quiz-feedback correct';
                if(selectedLabel) selectedLabel.classList.add('correct');
            } else {
                let correctAnswerText = '';
                if (correctAnswerLabel) {
                     // Find the text span within the correct label
                    const spanElement = correctAnswerLabel.querySelector('span');
                    correctAnswerText = spanElement ? spanElement.textContent.trim() : `é€‰é¡¹ ${correctAnswerValue}`;
                    correctAnswerLabel.classList.add('correct'); // Highlight the correct answer as well
                }
                feedbackElement.textContent = `å›ç­”é”™è¯¯ã€‚æ­£ç¡®ç­”æ¡ˆæ˜¯: "${correctAnswerText}"`;
                feedbackElement.className = 'quiz-feedback incorrect';
                if(selectedLabel) selectedLabel.classList.add('incorrect');
            }
            feedbackElement.style.display = 'block'; // Show feedback

            // Automatically show the answer explanation when checking
            const answerSection = quizCard.querySelector('.quiz-answer');
            const toggleButton = quizCard.querySelector('.quiz-toggle');
             if (answerSection && toggleButton && !answerSection.classList.contains('visible')) {
                 toggleAnswer(quizCard.id, toggleButton);
             }
        }


        document.addEventListener('DOMContentLoaded', () => {
            // --- TOC Highlighting Logic ---
            const sections = document.querySelectorAll('main section[id], main div[id^="utility-"]'); // Observe sections and utility cards
            const tocLinks = document.querySelectorAll('#local-toc a');
            let lastActiveTocLink = null;
            const tocObserverOptions = { root: null, rootMargin: '-20% 0px -60% 0px', threshold: 0 };

            const tocObserverCallback = (entries) => {
                let bestVisibleEntry = null;
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        if (!bestVisibleEntry || entry.boundingClientRect.top < bestVisibleEntry.boundingClientRect.top) {
                             bestVisibleEntry = entry;
                        }
                    }
                });

                if (bestVisibleEntry) {
                    const id = bestVisibleEntry.target.getAttribute('id');
                    let targetHref = `#${id}`;
                    // If the best visible entry is a utility card, target the parent link in TOC
                    if (id.startsWith('utility-')) {
                        targetHref = '#utility-types';
                    }

                    const activeLink = document.querySelector(`#local-toc a[href="${targetHref}"]`);

                    if (activeLink && activeLink !== lastActiveTocLink) {
                        if (lastActiveTocLink) {
                            lastActiveTocLink.classList.remove('active');
                            // Deactivate parent if sublink was active
                            const parentLi = lastActiveTocLink.closest('li.ml-4');
                            if(parentLi) {
                                const parentLink = parentLi.parentElement?.closest('li')?.querySelector('a');
                                parentLink?.classList.remove('active');
                            }
                        }
                        activeLink.classList.add('active');
                        // Activate parent link too if it's a sublink
                        const parentLi = activeLink.closest('li.ml-4');
                        if(parentLi) {
                            const parentLink = parentLi.parentElement?.closest('li')?.querySelector('a');
                            parentLink?.classList.add('active');
                        }
                        lastActiveTocLink = activeLink;
                    }
                }
            };
            const tocObserver = new IntersectionObserver(tocObserverCallback, tocObserverOptions);
            sections.forEach(section => tocObserver.observe(section));

            // Initial active link check
            const currentHash = window.location.hash;
            let initialActiveLinkFound = false;
            if (currentHash) {
                 let initialActiveLink = document.querySelector(`#local-toc a[href="${currentHash}"]`);
                 // If hash points to sub-item, find the parent TOC link
                 if (!initialActiveLink && currentHash.startsWith('#utility-')) {
                     initialActiveLink = document.querySelector(`#local-toc a[href="#utility-types"]`);
                 }

                if (initialActiveLink) {
                    tocLinks.forEach(link => link.classList.remove('active'));
                    initialActiveLink.classList.add('active');
                     const parentLi = initialActiveLink.closest('li.ml-4');
                     if(parentLi) {
                         const parentLink = parentLi.parentElement?.closest('li')?.querySelector('a');
                         parentLink?.classList.add('active');
                     }
                    lastActiveTocLink = initialActiveLink;
                    initialActiveLinkFound = true;
                }
            }
            // Default to first link if no hash or matching link found
            if (!initialActiveLinkFound && tocLinks.length > 0) {
                 tocLinks.forEach(link => link.classList.remove('active'));
                 tocLinks[0].classList.add('active');
                 lastActiveTocLink = tocLinks[0];
            }

            // --- Fade-in Animation Logic ---
            const mainContentSections = document.querySelectorAll('main > article > section.content-section');
            const fadeObserverOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
            const fadeObserverCallback = (entries, observer) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        const delayIndex = Array.from(mainContentSections).indexOf(entry.target);
                        entry.target.style.animationDelay = `${delayIndex * 0.05}s`;
                        entry.target.classList.add('fade-in-section');
                        observer.unobserve(entry.target);
                    }
                });
            };
            const fadeObserver = new IntersectionObserver(fadeObserverCallback, fadeObserverOptions);
            mainContentSections.forEach(section => fadeObserver.observe(section));

            // --- Initialize Quiz Buttons ---
             document.querySelectorAll('.quiz-card .quiz-toggle').forEach(button => {
                 button.addEventListener('click', (event) => {
                     createRipple(event); // Add ripple effect
                     // The checkAnswer function (called via onclick) will handle toggling the answer
                 });
             });


            // Manually trigger Prism highlighting
             Prism.highlightAll();
             // Re-run Mermaid rendering if needed (though initialize should handle it)
             try {
                mermaid.run();
             } catch(e) {
                 console.error("Error running mermaid:", e);
             }

        }); // End of DOMContentLoaded listener
    </script>

</body>

</html>
